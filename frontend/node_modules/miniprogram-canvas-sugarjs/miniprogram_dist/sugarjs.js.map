{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/shapes/object.class.js","webpack:///./src/utils/index.js","webpack:///./src/utils/misc.js","webpack:///./src/point.class.js","webpack:///./src/utils/object.js","webpack:///./src/shapes/image.class.js","webpack:///./src/gradient.class.js","webpack:///./src/color.class.js","webpack:///./src/pattern.class.js","webpack:///./src/sugarjs.js","webpack:///./src/canvas.class.js","webpack:///./src/shapes/text.class.js","webpack:///./src/utils/string.js","webpack:///./src/shapes/rect.class.js","webpack:///./src/shapes/polygon.class.js","webpack:///./src/shapes/triangle.class.js","webpack:///./src/shapes/circle.class.js","webpack:///./src/shapes/ellipse.class.js","webpack:///./src/mixins/shared_methods.mixin.js","webpack:///./src/mixins/observable.mixin.js","webpack:///./src/mixins/canvas_events.mixin.js","webpack:///./src/mixins/object_origin.mixin.js","webpack:///./src/mixins/object_interactivity.mixin.js","webpack:///./src/mixins/object_geometry.mixin.js","webpack:///./src/intersection.class.js","webpack:///./src/mixins/text_style.mixin.js"],"names":["require","multiplyTransformMatrices","qrDecompose","degreesToRadians","ObjectClass","options","type","originX","originY","top","left","width","height","scaleX","scaleY","flipX","flipY","opacity","angle","skewX","skewY","stroke","strokeWidth","strokeDashArray","strokeDashOffset","padding","cornerSize","touchCornerSize","transparentCorners","fill","backgroundColor","borderColor","borderDashArray","cornerColor","cornerStrokeColor","cornerStyle","cornerDashArray","centeredScaling","centeredRotation","selectable","evented","visible","hasControls","hasBorders","lockMovementX","lockMovementY","lockRotation","lockScalingX","lockScalingY","lockSkewingX","lockSkewingY","selectionBackgroundColor","paintFirst","borderScaleFactor","borderOpacityWhenMoving","minScaleLimit","__corner","initialize","setOptions","_setOptions","_initGradient","_initPattern","isNotVisible","render","ctx","save","drawSelectionBackground","transform","drawObject","restore","m","calcOwnMatrix","forClipping","originalFill","originalStroke","_renderBackground","_setStrokeStyles","_setFillStyles","_render","_removeShadow","shadow","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","_applyPatternGradientTransform","filler","toLive","offsetX","offsetY","t","gradientTransform","patternTransform","gradientUnits","_renderPaintInOrder","_renderStroke","_renderFill","fillRule","getViewportTransform","canvas","viewportTransform","concat","dim","_getNonTransformedDimensions","fillStyle","fillRect","x","y","getObjectOpacity","_set","key","value","console","log","shouldConstrainValue","_constrainScale","_setOpacity","group","_transformDone","globalAlpha","decl","lineWidth","lineCap","strokeLineCap","lineDashOffset","lineJoin","strokeLineJoin","miterLimit","strokeMiterLimit","strokeStyle","_setClippingProperties","_setLineDash","dashArray","alternative","length","push","apply","supportsLineDash","setLineDash","_renderControls","styleOverride","vpt","matrix","calcTransformMatrix","drawBorders","drawControls","translate","translateX","translateY","isMoving","forActiveSelection","rotate","drawBordersInGroup","shouldCenterOrigin","_setOriginToCenter","set","_resetOrigin","__uid","module","exports","compareVersion","v1","v2","split","len","Math","max","i","num1","parseInt","num2","slice","Array","prototype","invoke","array","method","args","call","arguments","result","byProperty","find","value1","value2","min","k","condition","toFixed","number","fractionDigits","parseFloat","Number","mergeMethods","a","b","prop","hasOwnProperty","PointClass","sqrt","atan2","pow","PiBy180","PI","PiBy2","invertTransform","r","o","transformPoint","p","ignoreOffset","populateWithProperties","source","destination","properties","Object","toString","loadImage","url","callback","context","query","wx","createSelectorQuery","select","fields","node","size","exec","res","getImageInfo","src","success","img","createImage","path","onload","onerror","fail","err","degrees","cos","angleSlice","sin","sign","sizeAfterTransform","dimX","dimY","points","transformMatrix","calcDimensionsMatrix","bbox","makeBoundingBoxFromPoints","scaleMatrix","multiply","tan","is2x2","xPoints","minX","maxX","yPoints","minY","maxY","denom","rotateVector","vector","radians","s","c","rx","ry","rotatePoint","point","origin","subtractEquals","v","addEquals","calcRotateMatrix","theta","composeMatrix","add","that","scalarAdd","scalar","scalarAddEquals","subtract","scalarSubtract","scalarSubtractEquals","multiplyEquals","divide","divideEquals","eq","lt","lte","gt","gte","lerp","distanceFrom","dx","dy","midPointFrom","setXY","setX","setY","setFromPoint","swap","clone","extend","deep","property","object","ImageClass","image","cacheKey","_filterScalingX","_filterScalingY","cropX","cropY","element","setElement","getElement","_element","_originalElement","_initConfig","_setWidthHeight","el","_stroke","elementToDraw","dW","dH","sW","sH","sX","sY","drawImage","w","h","beginPath","moveTo","lineTo","closePath","hasCrop","fromObject","_object","isError","fromURL","imgOptions","ColorClass","GradientClass","coords","_this","keys","forEach","option","id","x1","y1","x2","y2","r1","r2","colorStops","addColorStop","position","color","offset","toRgb","getAlpha","toObject","propertiesToInclude","gradient","createLinearGradient","createRadialGradient","setAlpha","toRgba","__convertPercentUnitsToValues","instance","svgOptions","propValue","finalValue","test","viewBoxWidth","viewBoxHeight","_tryParsingColor","colorNameMap","sourceFromHex","sourceFromRgb","sourceFromHsl","setSource","_rgbToHsl","g","l","d","round","getSource","_source","toHsl","hsl","toHsla","toHex","toUpperCase","toHexa","alpha","toGrayscale","average","currentAlpha","toBlackWhite","threshold","overlayWith","otherColor","Color","otherAlpha","otherSource","otherColorClass","reRGBa","reHSLa","reHex","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","hue2rgb","q","fromRgb","fromSource","match","fromRgba","fromHsl","fromHsla","fromHex","indexOf","isShortNotation","isRGBa","charAt","substring","oColor","oColorClass","PatternClass","repeat","NUM_FRACTION_DIGITS","toDataURL","crossOrigin","complete","naturalWidth","naturalHeight","createPattern","CanvasClass","TextClass","RectClass","PolygonClass","TriangleClass","CircleClass","EllipseClass","CommonMethods","Observable","CanvasEvent","ObjectOrigin","ObjectInteractivity","ObjectGeometry","TextStyles","Sugar","Canvas","Image","Text","Rect","Polygon","Triangle","Circle","Ellipse","Gradient","Pattern","Point","getContext","Error","dpr","getSystemInfoSync","pixelRatio","scale","backgroundImage","overlayImage","overlayColor","backgroundVpt","overlayVpt","controlsAboveOverlay","vptCoords","preserveObjectStacking","allowTouchScrolling","requestRenderAllBound","requestRenderAll","bind","_initStatic","_initInteractive","_currentTransform","_groupSelector","cb","_objects","_initOptions","setBackgroundImage","setBackgroundColor","_isRetinaScaling","enableRetinaScaling","getRetinaScaling","__setBgOverlayImage","__setBgOverlayColor","_onObjectAdded","remove","objects","index","somethingRemoved","splice","_onObjectRemoved","obj","setCoords","fire","target","_activeObject","_discardActiveObject","clearContext","clearRect","discardActiveObject","e","currentActives","getActiveObjects","activeObject","getActiveObject","_fireSelectionEvents","clear","_shouldClearSelection","activeObjects","_setupCurrentTransform","alreadySelected","pointer","getPointer","corner","action","ex","ey","lastX","lastY","_beforeTransform","_translateObject","newLeft","newTop","moveX","get","moveY","getZoom","isRendering","requestAnimationFrame","renderAll","calcViewportBoundaries","iVpt","tl","br","tr","bl","cancelRequestedRender","cancelAnimationFrame","renderCanvas","_chooseObjectsToRender","objsToRender","activeGroupObjects","_renderObjects","_renderBackgroundOrOverlay","needsVpt","_renderOverlay","getCenter","active","setActiveObject","_setActiveObject","onSelect","onDeselect","oldObjects","somethingChanged","added","removed","opt","oldObject","selected","deselected","updated","format","quality","graphemeSplit","text","fontSize","fontWeight","fontFamily","underline","overline","linethrough","textAlign","fontStyle","lineHeight","charSpacing","styles","_fontSizeMult","_fontSizeFraction","_reNewline","_reSpaceAndTab","_reSpacesAndTabs","__charBounds","MIN_TEXT_WIDTH","CACHE_FONT_SIZE","_styleProperties","_dimensionAffectingProps","initDimensions","_splitText","_clearCache","calcTextWidth","calcTextHeight","enlargeSpaces","diffSpace","currentLineWidth","numberOfSpaces","accumulatedSpace","line","charBound","spaces","_textLines","isEndOfWrapping","getLineWidth","textLines","j","jlen","kernedWidth","getFontCache","toLowerCase","charWidthsCache","cache","cacheProp","getHeightOfLine","lineIndex","__lineHeights","maxHeight","getHeightOfChar","_char","getValueOfPropertyAt","charIndex","charStyle","_getStyleDeclaration","__lineWidths","missingNewlineOffset","getMeasuringContext","_measuringContext","newLines","_splitTextIntoLines","lines","graphemeLines","_unwrappedTextLines","_unwrappedLines","_text","graphemeText","newLine","newText","pop","maxWidth","lineInfo","measureLine","_measureLine","_getWidthOfCharSpacing","grapheme","prevGrapheme","graphemeInfo","numOfSpaces","lineBounds","_getGraphemeBox","_renderTextCommon","lineHeights","_getLeftOffset","_getTopOffset","offsets","heightOfLine","leftOffset","_getLineLeftOffset","_renderTextLine","skipLeft","style","getCompleteStyleDeclaration","prevStyle","info","_measureChar","box","deltaY","previousBox","previousChar","prevCharStyle","fontCache","fontDeclaration","_getFontDeclaration","previousFontDeclaration","couple","stylesAreEqual","coupleWidth","previousWidth","fontMultiplier","undefined","_setTextStyles","measureText","styleObject","forMeasuring","font","_renderTextLinesBackground","textBackgroundColor","styleHas","lineTopOffset","lineLeftOffset","lastColor","topOffset","boxStart","boxWidth","charBox","currentColor","_renderTextDecoration","_size","_dy","lastDecoration","currentDecoration","currentFill","lastFill","_renderTextStroke","isEmptyStyles","affectStroke","_renderText","_renderTextFill","_renderChars","isJustify","actualStyle","nextStyle","charsToRender","timeToRender","shortCut","_renderChar","_hasStyleChanged","fullDecl","shouldFill","shouldStroke","_applyCharStyles","fillText","strokeText","styleDeclaration","thisStyle","needsDims","_key","genericFonts","camelize","string","replace","character","capitalize","firstLetterOnly","escapeXml","textstring","chr","graphemes","getWholeChar","str","code","charCodeAt","isNaN","next","prev","_initRxRy","isRounded","bezierCurveTo","_setPositionDimensions","calcDim","_calcDimensions","correctLeftTop","fromSVG","translateToGivenOrigin","pathOffset","commonRender","complexity","widthBy2","heightBy2","pi","radius","startAngle","endAngle","setRadius","arc","getRadiusX","getRadiusY","piBy2","getRx","getRy","_setObject","toggle","_removeEventListener","eventName","handler","__eventListeners","eventListener","on","off","listenersForEvent","filter","touchstart","_target","_handleEvent","findTarget","_pointer","shouldRender","_shouldRender","touchmove","touches","_transformObject","_resetTransformEventData","touchend","longtap","eventType","button","isClick","targets","subTargets","skipGroup","skipTargetFind","ignoreZoom","aObjects","activeTarget","activeTargetSubs","_searchPossibleTargets","_findTargetCorner","altSelectionKey","subTarget","objToCheck","_checkTarget","changedTouches","globalPointer","containsPoint","xy","reset","_performTransformAction","actionPerformed","_absolutePointer","__gesturesParams","__gesturesRenderer","originXOffset","center","right","originYOffset","bottom","fromOriginX","fromOriginY","toOriginX","toOriginY","_getTransformedDimensions","translateToCenterPoint","translateToOriginPoint","getCenterPoint","leftTop","getPointByOrigin","toLocalPoint","p2","setPositionByOrigin","pos","adjustPosition","to","hypotFull","getScaledWidth","xFull","yFull","offsetFrom","offsetTo","_originalOriginX","_originalOriginY","originPoint","_getLeftTopCoords","forTouch","oCoords","isControlVisible","_getImageLines","touchCorner","_findCrossPoints","forEachControl","fn","controls","_setCornerCoords","newTheta","cosTheta","sinTheta","cornerHypotenuse","touchHypotenuse","cosHalfOffset","sinHalfOffset","touchCosHalfOffset","touchSinHalfOffset","control","interactive","wh","_calculateCurrentDimensions","strokeRect","withConnection","getVisibility","strokeUniform","setTransform","controlKey","setControlVisible","_controlsVisibility","setControlsVisibility","IntersectionClass","arrayFromCoords","aCoords","lineCoords","ownMatrixCache","matrixCache","_getCoords","absolute","calculate","calcACoords","calcLineCoords","getCoords","intersectsWithRect","pointTL","pointBR","intersection","intersectPolygonRectangle","status","intersectsWithObject","other","intersectPolygonPolygon","isContainedWithinObject","otherCoords","isContainedWithinRect","boundingRect","getBoundingRect","isOnScreen","_containsCenterOfCanvas","centerPoint","isPartiallyOnScreen","topline","rightline","bottomline","leftline","b1","b2","a1","a2","xi","xcount","iLine","lineKey","getScaledHeight","abs","scaleToWidth","boundingRectFactor","scaleToHeight","calcCoords","calcOCoords","cosP","sinP","cosPSinP","cosPMinusSinP","rotateMatrix","_calcRotateMatrix","translateMatrix","_calcTranslateMatrix","startMatrix","finalMatrix","positionHandler","skipCorners","transformMatrixKey","sep","prefix","tMatrix","_calcDimensionsTransformMatrix","flipping","dimensions","noSkew","_finalizeDimensions","appendPoint","appendPoints","intersectLineLine","uaT","ubT","uB","ua","ub","Intersection","intersectLinePolygon","inter","points1","points2","topRight","bottomLeft","inter1","inter2","inter3","inter4","p1","p3","cleanStyle","stylesCount","letterCount","stylePropertyValue","allStyleObjectPropertiesMatch","graphemeCount","stylePropertyHasBeenSet","removeStyle","lineNum","charNum","_extendStyles","loc","get2DCursorLocation","_getLineStyle","_setLineStyle","_setStyleDeclaration","selectionStart","skipWrapping","getSelectionStyles","startIndex","endIndex","selectionEnd","getStyleAtPosition","setSelectionStyles","_forceClearCache","lineStyle","_deleteStyleDeclaration","_deleteLineStyle"],"mappings":"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","file":"sugarjs.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","/**\n * Created by Sugar on 2020/5/26.\n */\n\nconst {\n  multiplyTransformMatrices,\n  qrDecompose,\n  degreesToRadians\n} = require('../utils/misc')\n\nclass ObjectClass {\n  constructor(options) {\n    this.type = 'object'\n    this.originX = 'left'\n    this.originY = 'top'\n    this.top = 0\n    this.left = 0\n    this.width = 0\n    this.height = 0\n    this.originY = 'top'\n    this.scaleX = 1\n    this.scaleY = 1\n    this.flipX = false\n    this.flipY = false\n    this.opacity = 1\n    this.angle = 0\n    this.skewX = 0\n    this.skewY = 0\n    this.stroke = null\n    this.strokeWidth = 1\n    this.strokeDashArray = null\n    this.strokeDashOffset = 0\n    this.padding = 0\n    this.cornerSize = 13\n    this.touchCornerSize = 24\n    this.transparentCorners = true\n    this.fill = 'rgb(0,0,0)'\n    this.strokeWidth = 1\n    this.backgroundColor = ''\n    this.borderColor = 'orange'\n    this.borderDashArray = null\n    this.cornerColor = 'blue'\n    this.cornerStrokeColor = null\n    this.cornerStyle = 'rect'\n    this.cornerDashArray = null\n    this.centeredScaling = false\n    this.centeredRotation = true // 如果为true，则将以物体中心为原点\n    this.selectable = true\n    this.evented = true\n    this.visible = true\n    this.hasControls = true\n    this.hasBorders = true\n    this.lockMovementX = false\n    this.lockMovementY = false\n    this.lockRotation = false\n    this.lockScalingX = false\n    this.lockScalingY = false\n    this.lockSkewingX = false\n    this.lockSkewingY = false\n    this.selectionBackgroundColor = ''\n    this.paintFirst = 'stroke'\n    this.borderScaleFactor = 1\n    this.borderOpacityWhenMoving = 0.4\n    this.minScaleLimit = 0\n    this.__corner = 0\n  }\n\n  initialize(options) {\n    if (options) {\n      this.setOptions(options);\n    }\n  }\n\n  setOptions(options) {\n    this._setOptions(options);\n    this._initGradient(options.fill, 'fill');\n    this._initGradient(options.stroke, 'stroke');\n    this._initPattern(options.fill, 'fill');\n    this._initPattern(options.stroke, 'stroke');\n  }\n\n  /*\n   * @private\n   * 判断是否可渲染\n   * @memberOf sugar.Object.prototype\n   * @return {Boolean}\n   */\n  isNotVisible() {\n    return this.opacity === 0 || (!this.width && !this.height) || !this.visible\n  }\n\n  /**\n   * 在指定的上下文中渲染对象\n   * @param {CanvasContext} ctx 微信<canvas>组件的绘图上下文\n   */\n  render(ctx) {\n    if (this.isNotVisible()) {\n      return\n    }\n    ctx.save()\n    // this._setupCompositeOperation(ctx)\n    this.drawSelectionBackground(ctx)\n    this.transform(ctx)\n    // this._setOpacity(ctx)\n    // this._setShadow(ctx, this)\n    // if (this.shouldCache()) {\n    //   this.renderCache()\n    //   this.drawCacheOnCanvas(ctx);\n    // } else {\n    // this._removeCacheCanvas();\n    this.drawObject(ctx)\n    // if (this.objectCaching && this.statefullCache) {\n    //   this.saveState({propertySet: 'cacheProperties'});\n    // }\n    // }\n    ctx.restore()\n  }\n\n  transform(ctx) {\n    let m = this.calcOwnMatrix()\n    // if (this.group && !this.group._transformDone) {\n    //   m = this.calcTransformMatrix();\n    // }\n    // console.log(m)\n    ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n  }\n\n  drawObject(ctx, forClipping) {\n    let originalFill = this.fill\n    let originalStroke = this.stroke\n    if (forClipping) {\n      this.fill = 'black'\n      this.stroke = ''\n      // this._setClippingProperties(ctx) // TODO\n    } else {\n      this._renderBackground(ctx)\n      this._setStrokeStyles(ctx, this)\n      this._setFillStyles(ctx, this)\n    }\n    // 调用子类的_render方法，绘制到canvas\n    this._render(ctx)\n    // this._drawClipPath(ctx)\n    this.fill = originalFill\n    this.stroke = originalStroke\n  }\n\n  _removeShadow(ctx) {\n    if (!this.shadow) {\n      return;\n    }\n\n    ctx.shadowColor = '';\n    ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n  }\n\n  _applyPatternGradientTransform(ctx, filler) {\n    if (!filler || !filler.toLive) {\n      return {offsetX: 0, offsetY: 0};\n    }\n    var t = filler.gradientTransform || filler.patternTransform;\n    var offsetX = -this.width / 2 + filler.offsetX || 0,\n      offsetY = -this.height / 2 + filler.offsetY || 0;\n\n    if (filler.gradientUnits === 'percentage') {\n      ctx.transform(this.width, 0, 0, this.height, offsetX, offsetY);\n    } else {\n      ctx.transform(1, 0, 0, 1, offsetX, offsetY);\n    }\n    if (t) {\n      ctx.transform(t[0], t[1], t[2], t[3], t[4], t[5]);\n    }\n    return {offsetX: offsetX, offsetY: offsetY};\n  }\n\n  _renderPaintInOrder(ctx) {\n    if (this.paintFirst === 'stroke') {\n      this._renderStroke(ctx);\n      this._renderFill(ctx);\n    } else {\n      this._renderFill(ctx);\n      this._renderStroke(ctx);\n    }\n  }\n\n  _render() {\n\n  }\n\n  _renderFill(ctx) {\n    if (!this.fill) {\n      return;\n    }\n\n    ctx.save();\n    // this._applyPatternGradientTransform(ctx, this.fill);\n    if (this.fillRule === 'evenodd') {\n      ctx.fill('evenodd');\n    } else {\n      ctx.fill();\n    }\n    ctx.restore();\n  }\n\n  _renderStroke(ctx) {\n\n  }\n\n  getViewportTransform() {\n    if (this.canvas && this.canvas.viewportTransform) {\n      return this.canvas.viewportTransform;\n    }\n    return [1, 0, 0, 1, 0, 0].concat();\n  }\n\n  /**\n   * 为对象绘制背景，尺寸不变\n   * @private\n   * @param {CanvasRenderingContext2D} ctx\n   */\n  _renderBackground(ctx) {\n    if (!this.backgroundColor) {\n      return;\n    }\n    let dim = this._getNonTransformedDimensions();\n    ctx.fillStyle = this.backgroundColor;\n\n    ctx.fillRect(\n      -dim.x / 2,\n      -dim.y / 2,\n      dim.x,\n      dim.y\n    );\n    // if there is background color no other shadows\n    // should be casted\n    // this._removeShadow(ctx);\n  }\n\n  getObjectOpacity() {\n    let opacity = this.opacity;\n    // if (this.group) {\n    // opacity *= this.group.getObjectOpacity();\n    // }\n    return opacity;\n  }\n\n  _set(key, value) {\n    console.log('set scaleX')\n    let shouldConstrainValue = (key === 'scaleX' || key === 'scaleY')\n\n    if (shouldConstrainValue) {\n      value = this._constrainScale(value);\n    }\n    if (key === 'scaleX' && value < 0) {\n      this.flipX = !this.flipX\n      value *= -1;\n    } else if (key === 'scaleY' && value < 0) {\n      this.flipY = !this.flipY\n      value *= -1;\n    }\n\n    this[key] = value;\n\n    return this\n  }\n\n  _setOpacity(ctx) {\n    if (this.group && !this.group._transformDone) {\n      ctx.globalAlpha = this.getObjectOpacity();\n    } else {\n      ctx.globalAlpha *= this.opacity;\n    }\n  }\n\n  _setStrokeStyles(ctx, decl) {\n    if (decl.stroke) {\n      ctx.lineWidth = decl.strokeWidth;\n      ctx.lineCap = decl.strokeLineCap;\n      ctx.lineDashOffset = decl.strokeDashOffset;\n      ctx.lineJoin = decl.strokeLineJoin;\n      ctx.miterLimit = decl.strokeMiterLimit;\n      ctx.strokeStyle = decl.stroke.toLive\n        ? decl.stroke.toLive(ctx, this)\n        : decl.stroke;\n    }\n  }\n\n  _setFillStyles(ctx, decl) {\n    if (decl.fill) {\n      ctx.fillStyle = decl.fill.toLive\n        ? decl.fill.toLive(ctx, this)\n        : decl.fill;\n    }\n  }\n\n  _setClippingProperties(ctx) {\n    ctx.globalAlpha = 1;\n    ctx.strokeStyle = 'transparent';\n    ctx.fillStyle = '#000000';\n  }\n\n  _setLineDash(ctx, dashArray, alternative) {\n    if (!dashArray || dashArray.length === 0) {\n      return;\n    }\n    if (1 & dashArray.length) {\n      dashArray.push.apply(dashArray, dashArray);\n    }\n    if (supportsLineDash) {\n      ctx.setLineDash(dashArray);\n    } else {\n      alternative && alternative(ctx);\n    }\n  }\n\n  /**\n   * 渲染对象的控件和边框\n   * @param {CanvasRenderingContext2D} ctx\n   * @param {Object} [styleOverride] 覆盖对象样式的属性\n   */\n  _renderControls(ctx, styleOverride) {\n    let vpt = this.getViewportTransform(),\n      matrix = this.calcTransformMatrix(),\n      options, drawBorders, drawControls;\n    styleOverride = styleOverride || {};\n    drawBorders = typeof styleOverride.hasBorders !== 'undefined' ? styleOverride.hasBorders : this.hasBorders;\n    drawControls = typeof styleOverride.hasControls !== 'undefined' ? styleOverride.hasControls : this.hasControls;\n    matrix = multiplyTransformMatrices(vpt, matrix);\n    options = qrDecompose(matrix);\n    ctx.save();\n    ctx.translate(options.translateX, options.translateY);\n    ctx.lineWidth = 1 * this.borderScaleFactor;\n    if (!this.group) {\n      ctx.globalAlpha = this.isMoving ? this.borderOpacityWhenMoving : 1;\n    }\n    if (styleOverride.forActiveSelection) {\n      ctx.rotate(degreesToRadians(options.angle));\n      drawBorders && this.drawBordersInGroup(ctx, options, styleOverride);\n    } else {\n      ctx.rotate(degreesToRadians(this.angle));\n      drawBorders && this.drawBorders(ctx, styleOverride);\n    }\n    drawControls && this.drawControls(ctx, styleOverride);\n    ctx.restore();\n  }\n\n  rotate(angle) {\n    let shouldCenterOrigin = (this.originX !== 'center' || this.originY !== 'center') && this.centeredRotation;\n\n    if (shouldCenterOrigin) {\n      this._setOriginToCenter();\n    }\n\n    this.set('angle', angle);\n\n    if (shouldCenterOrigin) {\n      this._resetOrigin();\n    }\n\n    return this\n  }\n}\n\nObjectClass.__uid = 0\n\nmodule.exports = ObjectClass\n","/**\n * Created by Sugar on 2020/5/25.\n */\n\n/**\n * 小程序版本库版本号比较\n * @param v1\n * @param v2\n * @returns {number}\n */\nconst compareVersion = (v1, v2) => {\n  v1 = v1.split('.')\n  v2 = v2.split('.')\n  const len = Math.max(v1.length, v2.length)\n  while (v1.length < len) {\n    v1.push('0')\n  }\n  while (v2.length < len) {\n    v2.push('0')\n  }\n  for (let i = 0; i < len; i++) {\n    const num1 = parseInt(v1[i], 10)\n    const num2 = parseInt(v2[i], 10)\n\n    if (num1 > num2) {\n      return 1\n    } else if (num1 < num2) {\n      return -1\n    }\n  }\n\n  return 0\n}\n\n\nlet slice = Array.prototype.slice;\n\nfunction invoke(array, method) {\n  let args = slice.call(arguments, 2), result = [];\n  for (let i = 0, len = array.length; i < len; i++) {\n    result[i] = args.length ? array[i][method].apply(array[i], args) : array[i][method].call(array[i]);\n  }\n  return result;\n}\n\nfunction max(array, byProperty) {\n  return find(array, byProperty, function (value1, value2) {\n    return value1 >= value2;\n  });\n}\n\nfunction min(array, byProperty) {\n  return find(array, byProperty, function (value1, value2) {\n    return value1 < value2;\n  });\n}\n\nfunction fill(array, value) {\n  let k = array.length;\n  while (k--) {\n    array[k] = value;\n  }\n  return array;\n}\n\nfunction find(array, byProperty, condition) {\n  if (!array || array.length === 0) {\n    return;\n  }\n\n  let i = array.length - 1,\n    result = byProperty ? array[i][byProperty] : array[i];\n  if (byProperty) {\n    while (i--) {\n      if (condition(array[i][byProperty], result)) {\n        result = array[i][byProperty];\n      }\n    }\n  } else {\n    while (i--) {\n      if (condition(array[i], result)) {\n        result = array[i];\n      }\n    }\n  }\n  return result;\n}\n\nfunction toFixed(number, fractionDigits) {\n  return parseFloat(Number(number).toFixed(fractionDigits));\n}\n\nfunction mergeMethods(a, b) {\n  for (const prop in b) {\n    if (b.hasOwnProperty(prop)) {\n      a.prototype[prop] = b[prop]\n    }\n  }\n  return a\n}\n\nmodule.exports = {\n  compareVersion,\n  fill,\n  invoke,\n  min,\n  max,\n  toFixed,\n  mergeMethods\n}\n","/**\n * Created by Sugar on 2020/5/26.\n */\nconst PointClass = require('../point.class')\nconst {min, max} = require('./index')\n\nlet sqrt = Math.sqrt,\n  atan2 = Math.atan2,\n  pow = Math.pow,\n  PiBy180 = Math.PI / 180,\n  PiBy2 = Math.PI / 2\n\n/**\n * 逆向变换t\n * @param {Array} t 要变换的数据\n * @return {Array} 变换后的数据\n */\nconst invertTransform = (t) => {\n  let a = 1 / (t[0] * t[3] - t[1] * t[2]),\n    r = [a * t[3], -a * t[1], -a * t[2], a * t[0]],\n    o = transformPoint({x: t[4], y: t[5]}, r, true)\n  r[4] = -o.x\n  r[5] = -o.y\n  return r\n}\n\n/**\n * 将变换t应用于点p\n * @static\n * @param  {sugar.Point} p 转变点\n * @param  {Array} t 矩阵\n * @param  {Boolean} [ignoreOffset] 指定是否不偏移\n * @return {sugar.Point} 转换后的点\n */\nconst transformPoint = (p, t, ignoreOffset) => {\n  if (ignoreOffset) {\n    return new PointClass(\n      t[0] * p.x + t[2] * p.y,\n      t[1] * p.x + t[3] * p.y\n    )\n  }\n  return new PointClass(\n    t[0] * p.x + t[2] * p.y + t[4],\n    t[1] * p.x + t[3] * p.y + t[5]\n  )\n}\n\n/**\n * 用另一个对象的属性填充一个对象\n * @static\n * @param {Object} source 源对象\n * @param {Object} destination 目标对象\n * @return {Array} properties 要包括的属性名称\n */\nconst populateWithProperties = (source, destination, properties) => {\n  if (properties && Object.prototype.toString.call(properties) === '[object Array]') {\n    for (let i = 0, len = properties.length; i < len; i++) {\n      if (properties[i] in source) {\n        destination[properties[i]] = source[properties[i]];\n      }\n    }\n  }\n}\n\n\n/**\n * 获取图片。网络图片需先配置download域名才能生效。\n * @param {String} url\n * @param {Function} callback\n * @param {*} [context] 调用回调的上下文\n */\nconst loadImage = (url, callback, context) => {\n  if (!url) {\n    callback && callback.call(context, url);\n    return;\n  }\n\n  const query = wx.createSelectorQuery()\n  query.select(`#sugarjs`)\n    .fields({node: true, size: true})\n    .exec(res => {\n      const canvas = res[0].node\n      wx.getImageInfo({\n        src: url,\n        success(res) {\n          /**\n           * res数据结构\n           width  number  图片原始宽度，单位px。不考虑旋转。\n           height  number  图片原始高度，单位px。不考虑旋转。\n           path  string  图片的本地路径\n           orientation  string  拍照时设备方向\n           type  string  图片格式\n           */\n          let img = canvas.createImage()\n          img.src = res.path\n          img.onload = (res) => {\n            callback && callback.call(context, img, false)\n            img = img.onload = img.onerror = null\n          }\n\n          img.onerror = () => {\n            callback && callback.call(context, null, true)\n            img = img.onload = img.onerror = null\n          }\n\n          // callback && callback.call(context, res, false)\n        },\n        fail(err) {\n          callback && callback.call(context, null, true)\n        }\n      })\n    })\n}\n\nconst degreesToRadians = (degrees) => {\n  return degrees * PiBy180\n}\n\nconst cos = (angle) => {\n  if (angle === 0) {\n    return 1;\n  }\n  if (angle < 0) {\n    // cos(a) = cos(-a)\n    angle = -angle;\n  }\n  let angleSlice = angle / PiBy2;\n  switch (angleSlice) {\n    case 1:\n    case 3:\n      return 0;\n    case 2:\n      return -1;\n  }\n  return Math.cos(angle);\n}\n\nconst sin = (angle) => {\n  if (angle === 0) {\n    return 0;\n  }\n  let angleSlice = angle / PiBy2, sign = 1;\n  if (angle < 0) {\n    // sin(-a) = -sin(a)\n    sign = -1;\n  }\n  switch (angleSlice) {\n    case 1:\n      return sign;\n    case 2:\n      return 0;\n    case 3:\n      return -sign;\n  }\n  return Math.sin(angle);\n}\n\nconst sizeAfterTransform = (width, height, options) => {\n  let dimX = width / 2, dimY = height / 2,\n    points = [\n      {\n        x: -dimX,\n        y: -dimY\n      },\n      {\n        x: dimX,\n        y: -dimY\n      },\n      {\n        x: -dimX,\n        y: dimY\n      },\n      {\n        x: dimX,\n        y: dimY\n      }],\n    transformMatrix = calcDimensionsMatrix(options),\n    bbox = makeBoundingBoxFromPoints(points, transformMatrix);\n  return {\n    x: bbox.width,\n    y: bbox.height,\n  };\n}\n\nconst calcDimensionsMatrix = (options) => {\n  let scaleX = typeof options.scaleX === 'undefined' ? 1 : options.scaleX,\n    scaleY = typeof options.scaleY === 'undefined' ? 1 : options.scaleY,\n    scaleMatrix = [\n      options.flipX ? -scaleX : scaleX,\n      0,\n      0,\n      options.flipY ? -scaleY : scaleY,\n      0,\n      0],\n    multiply = multiplyTransformMatrices;\n  if (options.skewX) {\n    scaleMatrix = multiply(\n      scaleMatrix,\n      [1, 0, Math.tan(degreesToRadians(options.skewX)), 1],\n      true);\n  }\n  if (options.skewY) {\n    scaleMatrix = multiply(\n      scaleMatrix,\n      [1, Math.tan(degreesToRadians(options.skewY)), 0, 1],\n      true);\n  }\n  return scaleMatrix;\n}\n\nconst multiplyTransformMatrices = (a, b, is2x2) => {\n  return [\n    a[0] * b[0] + a[2] * b[1],\n    a[1] * b[0] + a[3] * b[1],\n    a[0] * b[2] + a[2] * b[3],\n    a[1] * b[2] + a[3] * b[3],\n    is2x2 ? 0 : a[0] * b[4] + a[2] * b[5] + a[4],\n    is2x2 ? 0 : a[1] * b[4] + a[3] * b[5] + a[5]\n  ];\n}\n\nconst makeBoundingBoxFromPoints = (points, transform) => {\n  if (transform) {\n    for (let i = 0; i < points.length; i++) {\n      points[i] = transformPoint(points[i], transform);\n    }\n  }\n  let xPoints = [points[0].x, points[1].x, points[2].x, points[3].x],\n    minX = min(xPoints),\n    maxX = max(xPoints),\n    width = maxX - minX,\n    yPoints = [points[0].y, points[1].y, points[2].y, points[3].y],\n    minY = min(yPoints),\n    maxY = max(yPoints),\n    height = maxY - minY;\n\n  return {\n    left: minX,\n    top: minY,\n    width: width,\n    height: height\n  };\n}\n\nconst qrDecompose = (a) => {\n  let angle = atan2(a[1], a[0]),\n    denom = pow(a[0], 2) + pow(a[1], 2),\n    scaleX = sqrt(denom),\n    scaleY = (a[0] * a[3] - a[2] * a[1]) / scaleX,\n    skewX = atan2(a[0] * a[2] + a[1] * a [3], denom);\n  return {\n    angle: angle / PiBy180,\n    scaleX: scaleX,\n    scaleY: scaleY,\n    skewX: skewX / PiBy180,\n    skewY: 0,\n    translateX: a[4],\n    translateY: a[5]\n  };\n}\n\nconst rotateVector = (vector, radians) => {\n  let s = sin(radians),\n    c = cos(radians),\n    rx = vector.x * c - vector.y * s,\n    ry = vector.x * s + vector.y * c;\n  return {\n    x: rx,\n    y: ry\n  };\n}\n\nconst rotatePoint = (point, origin, radians) => {\n  point.subtractEquals(origin);\n  let v = rotateVector(point, radians);\n  return new PointClass(v.x, v.y).addEquals(origin);\n}\n\nconst calcRotateMatrix = (options) => {\n  if (!options.angle) {\n    return [1, 0, 0, 1, 0, 0].concat();\n  }\n  let theta = degreesToRadians(options.angle),\n    c = cos(theta),\n    s = sin(theta);\n  return [c, s, -s, c, 0, 0];\n}\n\nconst composeMatrix = (options) => {\n  var matrix = [1, 0, 0, 1, options.translateX || 0, options.translateY || 0],\n    multiply = multiplyTransformMatrices;\n  if (options.angle) {\n    matrix = multiply(matrix, calcRotateMatrix(options));\n  }\n  if (options.scaleX !== 1 || options.scaleY !== 1 ||\n    options.skewX || options.skewY || options.flipX || options.flipY) {\n    matrix = multiply(matrix, calcDimensionsMatrix(options));\n  }\n  return matrix;\n}\n\nmodule.exports = {\n  invertTransform,\n  transformPoint,\n  populateWithProperties,\n  makeBoundingBoxFromPoints,\n  loadImage,\n  degreesToRadians,\n  cos,\n  sin,\n  sizeAfterTransform,\n  calcDimensionsMatrix,\n  multiplyTransformMatrices,\n  qrDecompose,\n  rotateVector,\n  rotatePoint,\n  calcRotateMatrix,\n  composeMatrix,\n}\n","/**\n * Created by Sugar on 2020/5/26.\n */\n\nclass PointClass {\n  constructor(x, y) {\n    this.type = 'point'\n    this.x = x\n    this.y = y\n  }\n\n  /**\n   * 向当前点添加另一点的值并返回新点\n   * @param {sugar.Point} that\n   * @return {sugar.Point} new PointClass\n   */\n  add(that) {\n    return new PointClass(this.x + that.x, this.y + that.y)\n  }\n\n  /**\n   * 在当前的点添加另一点\n   * @param {sugar.Point} that\n   * @return {sugar.Point} thisArg\n   * @chainable\n   */\n  addEquals(that) {\n    this.x += that.x\n    this.y += that.y\n    return this\n  }\n\n  /**\n   * 在当前点加值并返回一个新的点\n   * @param {Number} scalar\n   * @return {sugar.Point} new PointClass\n   */\n  scalarAdd(scalar) {\n    return new PointClass(this.x + scalar, this.y + scalar)\n  }\n\n  /**\n   * 在当前的点加值\n   * @param {Number} scalar\n   * @return {sugar.Point} thisArg\n   */\n  scalarAddEquals(scalar) {\n    this.x += scalar\n    this.y += scalar\n    return this\n  }\n\n  /**\n   * 向该点减另一点的值并返回新点\n   * @param {sugar.Point} that\n   * @return {sugar.Point} new PointClass\n   */\n  subtract(that) {\n    return new PointClass(this.x - that.x, this.y - that.y)\n  }\n\n  /**\n   * 在当前的点减值\n   * @param {sugar.Point} that\n   * @return {sugar.Point} thisArg\n   * @chainable\n   */\n  subtractEquals(that) {\n    this.x -= that.x\n    this.y -= that.y\n    return this\n  }\n\n  /**\n   * 向当前点减值并返回新的点\n   * @param {Number} scalar\n   * @return {sugar.Point}\n   */\n  scalarSubtract(scalar) {\n    return new PointClass(this.x - scalar, this.y - scalar)\n  }\n\n  /**\n   * 当前点减值\n   * @param {Number} scalar\n   * @return {sugar.Point} thisArg\n   */\n  scalarSubtractEquals(scalar) {\n    this.x -= scalar\n    this.y -= scalar\n    return this\n  }\n\n\n  multiply(scalar) {\n    return new PointClass(this.x * scalar, this.y * scalar)\n  }\n\n  multiplyEquals(scalar) {\n    this.x *= scalar\n    this.y *= scalar\n    return this\n  }\n\n  divide(scalar) {\n    return new PointClass(this.x / scalar, this.y / scalar)\n  }\n\n  divideEquals(scalar) {\n    this.x /= scalar\n    this.y /= scalar\n    return this\n  }\n\n  /**\n   * 如果此点等于另一点，则返回true\n   * @param {sugar.Point} that\n   * @return {Boolean}\n   */\n  eq(that) {\n    return (this.x === that.x && this.y === that.y)\n  }\n\n  /**\n   * 如果此点小于另一点，则返回true\n   * @param {sugar.Point} that\n   * @return {Boolean}\n   */\n  lt(that) {\n    return (this.x < that.x && this.y < that.y)\n  }\n\n  /**\n   * 如果此点小于或等于另一点，则返回true\n   * @param {sugar.Point} that\n   * @return {Boolean}\n   */\n  lte(that) {\n    return (this.x <= that.x && this.y <= that.y)\n  }\n\n  /**\n\n   * 如果此点大于另一点，则返回true\n   * @param {sugar.Point} that\n   * @return {Boolean}\n   */\n  gt(that) {\n    return (this.x > that.x && this.y > that.y)\n  }\n\n  /**\n   * 如果此点大于或等于另一点，则返回true\n   * @param {sugar.Point} that\n   * @return {Boolean}\n   */\n  gte(that) {\n    return (this.x >= that.x && this.y >= that.y)\n  }\n\n\n  lerp(that, t) {\n    if (typeof t === 'undefined') {\n      t = 0.5\n    }\n    t = Math.max(Math.min(1, t), 0)\n    return new PointClass(this.x + (that.x - this.x) * t, this.y + (that.y - this.y) * t)\n  }\n\n  /**\n   * 返回此点与另一点的距离\n   * @param {sugar.Point} that\n   * @return {Number}\n   */\n  distanceFrom(that) {\n    var dx = this.x - that.x,\n      dy = this.y - that.y\n    return Math.sqrt(dx * dx + dy * dy)\n  }\n\n  /**\n   * 返回此点与另一点之间的点\n   * @param {sugar.Point} that\n   * @return {sugar.Point}\n   */\n  midPointFrom(that) {\n    return this.lerp(that)\n  }\n\n  /**\n   * 返回一个新点，该点是该点和另一个点的最小值\n   * @param {sugar.Point} that\n   * @return {sugar.Point}\n   */\n  min(that) {\n    return new PointClass(Math.min(this.x, that.x), Math.min(this.y, that.y))\n  }\n\n  /**\n   * 返回一个新点，该点是该点和另一个点的最大值\n   * @param {sugar.Point} that\n   * @return {sugar.Point}\n   */\n  max(that) {\n    return new PointClass(Math.max(this.x, that.x), Math.max(this.y, that.y))\n  }\n\n  /**\n   * 返回此点的字符串表示形式\n   * @return {String}\n   */\n  toString() {\n    return this.x + ',' + this.y\n  }\n\n  /**\n   * 设置此点的x/y\n   * @param {Number} x\n   * @param {Number} y\n   * @chainable\n   */\n  setXY(x, y) {\n    this.x = x\n    this.y = y\n    return this\n  }\n\n  /**\n   * 设置此点的x\n   * @param {Number} x\n   * @chainable\n   */\n  setX(x) {\n    this.x = x\n    return this\n  }\n\n  /**\n   * 设置此点的y\n   * @param {Number} y\n   * @chainable\n   */\n  setY(y) {\n    this.y = y\n    return this\n  }\n\n  /**\n   * 从另一个点设置该点的x/y\n   * @param {sugar.Point} that\n   * @chainable\n   */\n  setFromPoint(that) {\n    this.x = that.x\n    this.y = that.y\n    return this\n  }\n\n  /**\n   * 和另一个点交换x和y\n   * @param {sugar.Point} that\n   */\n  swap(that) {\n    var x = this.x,\n      y = this.y\n    this.x = that.x\n    this.y = that.y\n    that.x = x\n    that.y = y\n  }\n\n  /**\n   * 返回该点的克隆实例\n   * @return {sugar.Point}\n   */\n  clone() {\n    return new PointClass(this.x, this.y)\n  }\n}\n\nmodule.exports = PointClass\n","/**\n * Created by Sugar on 2020/5/26.\n */\n\nfunction extend(destination, source, deep) {\n  if (deep) {\n    if (source instanceof Array) {\n      destination = []\n      for (var i = 0, len = source.length; i < len; i++) {\n        destination[i] = extend({}, source[i], deep)\n      }\n    } else if (source && typeof source === 'object') {\n      for (var property in source) {\n        if (property === 'canvas') {\n          destination[property] = extend({}, source[property])\n        } else if (source.hasOwnProperty(property)) {\n          destination[property] = extend({}, source[property], deep)\n        }\n      }\n    } else {\n      destination = source\n    }\n  } else {\n    for (var property in source) {\n      destination[property] = source[property]\n    }\n  }\n  return destination\n}\n\nfunction clone(object, deep) {\n  return extend({}, object, deep)\n}\n\nmodule.exports = {\n  extend,\n  clone\n}\n","/**\n * Created by Sugar on 2020/5/26.\n */\nconst ObjectClass = require('./object.class')\nconst {clone} = require('../utils/object')\nconst {loadImage} = require('../utils/misc')\n\nclass ImageClass extends ObjectClass {\n  constructor(image, options) {\n    super(options)\n\n    this.type = 'image'\n    this.cacheKey = '' // 用于检索图像的标识key\n    this._filterScalingX = 1\n    this._filterScalingY = 1\n    this.cropX = 0\n    this.cropY = 0\n\n    this.initialize(image, options)\n  }\n\n  initialize(element, options) {\n    options || (options = {});\n    // this.filters = [];\n    this.cacheKey = 'texture' + ObjectClass.__uid++;\n    this.setElement(element, options);\n  }\n\n  getElement() {\n    return this._element || {};\n  }\n\n  setElement(element, options) {\n    // this.removeTexture(this.cacheKey);\n    // this.removeTexture(this.cacheKey + '_filtered');\n    this._element = element;\n    this._originalElement = element;\n    this._initConfig(options);\n    // if (this.filters.length !== 0) {\n    //   this.applyFilters();\n    // }\n\n    return this\n  }\n\n  _initConfig(options) {\n    options || (options = {});\n    this.setOptions(options);\n    this._setWidthHeight(options);\n  }\n\n  _setWidthHeight(options) {\n    options || (options = {});\n    let el = this.getElement();\n    // el.width el.height为图像原始宽高\n    let width = options.width || el.width || 0;\n    let height = options.height || el.height || 0;\n    this.width = width\n    this.height = height\n  }\n\n  _render(ctx) {\n    this._stroke(ctx)\n    this._renderPaintInOrder(ctx)\n  }\n\n  _renderFill(ctx) {\n    // console.log('绘制图片', this)\n    let elementToDraw = this._element\n    if (!elementToDraw) {\n      return;\n    }\n    let dW = this.width, dH = this.height,\n      // elementToDraw的width和height为图像原始宽高\n      sW = Math.min(elementToDraw.width, dW * this._filterScalingX),\n      sH = Math.min(elementToDraw.height, dH * this._filterScalingY),\n      dx = -dW / 2, dy = -dH / 2,\n      sX = Math.max(0, this.cropX * this._filterScalingX),\n      sY = Math.max(0, this.cropY * this._filterScalingY)\n    // console.log(sX, sY, sW, sH, dx, dy, dW, dH);\n    elementToDraw && ctx.drawImage(elementToDraw, sX, sY, sW, sH, dx, dy, dW, dH)\n    // elementToDraw && ctx.drawImage(elementToDraw, sX, sY, sW, sH, 0, 0, dW, dH)\n    // elementToDraw && ctx.drawImage(elementToDraw, this.left, this.top, sW, sH)\n  }\n\n  _stroke(ctx) {\n    if (!this.stroke || this.strokeWidth === 0) {\n      return;\n    }\n    let w = this.width / 2, h = this.height / 2\n    ctx.beginPath()\n    ctx.moveTo(-w, -h)\n    ctx.lineTo(w, -h)\n    ctx.lineTo(w, h)\n    ctx.lineTo(-w, h)\n    ctx.lineTo(-w, -h)\n    ctx.closePath()\n  }\n\n  /**\n   * 图像是否应用了裁剪\n   * @return {Boolean}\n   */\n  hasCrop() {\n    return this.cropX || this.cropY || this.width < this._element.width || this.height < this._element.height\n  }\n}\n\n/**\n * 通过对象创建sugar.Image实例\n * @static\n * @param {Object} object\n * @param {Function} callback 图像创建成功后的回调\n */\nImageClass.fromObject = (_object, callback) => {\n  let object = clone(_object)\n  loadImage(object.src, (img, isError) => {\n    if (isError) {\n      callback && callback(null, true);\n      return;\n    }\n    const image = new ImageClass(img, object)\n    callback(image, false)\n  }, null)\n}\n\n/**\n * 通过URL创建sugar.Image实例\n * @static\n * @param {String} url 图像URL\n * @param {Function} [callback]\n * @param {Object} [imgOptions]\n */\nImageClass.fromURL = (url, callback, imgOptions) => {\n  loadImage(url, (img, isError) => {\n    callback && callback(new ImageClass(img, imgOptions), isError);\n  }, null)\n}\n\nmodule.exports = ImageClass\n","/**\n * Created by Sugar on 2020/5/26.\n */\nconst ObjectClass = require('./shapes/object.class')\nconst ColorClass = require('color.class')\nconst {clone} = require('./utils/object')\nconst {populateWithProperties} = require('./utils/misc')\n\nclass GradientClass {\n  constructor(options) {\n    this.type = 'linear' // linear 或 radial\n    this.offsetX = 0\n    this.offsetY = 0\n    this.gradientTransform = null\n    this.gradientUnits = 'pixels'\n    this.initialize(options)\n  }\n\n  initialize(options) {\n    options || (options = {});\n    options.coords || (options.coords = {});\n\n    let coords, _this = this;\n\n    // sets everything, then coords and colorstops get sets again\n    Object.keys(options).forEach(function (option) {\n      _this[option] = options[option];\n    });\n\n    if (this.id) {\n      this.id += '_' + ObjectClass.__uid++;\n    } else {\n      this.id = ObjectClass.__uid++;\n    }\n\n    coords = {\n      x1: options.coords.x1 || 0,\n      y1: options.coords.y1 || 0,\n      x2: options.coords.x2 || 0,\n      y2: options.coords.y2 || 0\n    };\n\n    if (this.type === 'radial') {\n      coords.r1 = options.coords.r1 || 0;\n      coords.r2 = options.coords.r2 || 0;\n    }\n\n    this.coords = coords;\n    this.colorStops = options.colorStops.slice();\n  }\n\n  addColorStop(colorStops) {\n    for (const position in colorStops) {\n      var color = new ColorClass(colorStops[position])\n      this.colorStops.push({\n        offset: parseFloat(position),\n        color: color.toRgb(),\n        opacity: color.getAlpha()\n      })\n    }\n    return this\n  }\n\n  toObject(propertiesToInclude) {\n    let object = {\n      type: this.type,\n      coords: this.coords,\n      colorStops: this.colorStops,\n      offsetX: this.offsetX,\n      offsetY: this.offsetY,\n      gradientUnits: this.gradientUnits,\n      gradientTransform: this.gradientTransform ? this.gradientTransform.concat() : this.gradientTransform\n    };\n    populateWithProperties(this, object, propertiesToInclude);\n\n    return object;\n  }\n\n  /**\n   * 返回CanvasGradient的实例\n   * @param {CanvasContext} ctx\n   * @return {CanvasGradient}\n   */\n  toLive(ctx) {\n    let gradient, coords = clone(this.coords), i, len;\n\n    if (!this.type) {\n      return;\n    }\n\n    if (this.type === 'linear') {\n      gradient = ctx.createLinearGradient(\n        coords.x1, coords.y1, coords.x2, coords.y2);\n    } else if (this.type === 'radial') {\n      gradient = ctx.createRadialGradient(\n        coords.x1, coords.y1, coords.r1, coords.x2, coords.y2, coords.r2);\n    }\n\n    for (i = 0, len = this.colorStops.length; i < len; i++) {\n      var color = this.colorStops[i].color,\n        opacity = this.colorStops[i].opacity,\n        offset = this.colorStops[i].offset;\n\n      if (typeof opacity !== 'undefined') {\n        color = new ColorClass(color).setAlpha(opacity).toRgba();\n      }\n      gradient.addColorStop(offset, color);\n    }\n\n    return gradient;\n  }\n}\n\n/**\n * @private\n */\nfunction __convertPercentUnitsToValues(instance, options, svgOptions, gradientUnits) {\n  var propValue, finalValue;\n  Object.keys(options).forEach(function (prop) {\n    propValue = options[prop];\n    if (propValue === 'Infinity') {\n      finalValue = 1;\n    } else if (propValue === '-Infinity') {\n      finalValue = 0;\n    } else {\n      finalValue = parseFloat(options[prop], 10);\n      if (typeof propValue === 'string' && /^(\\d+\\.\\d+)%|(\\d+)%$/.test(propValue)) {\n        finalValue *= 0.01;\n        if (gradientUnits === 'pixels') {\n          // then we need to fix those percentages here in svg parsing\n          if (prop === 'x1' || prop === 'x2' || prop === 'r2') {\n            finalValue *= svgOptions.viewBoxWidth || svgOptions.width;\n          }\n          if (prop === 'y1' || prop === 'y2') {\n            finalValue *= svgOptions.viewBoxHeight || svgOptions.height;\n          }\n        }\n      }\n    }\n    options[prop] = finalValue;\n  });\n}\n\nmodule.exports = GradientClass\n","/**\n * Created by Sugar on 2020/5/26.\n */\nconst {max, min} = require('./utils/index')\n\nclass ColorClass {\n  constructor() {\n\n  }\n\n  _tryParsingColor(color) {\n    let source;\n\n    if (color in ColorClass.colorNameMap) {\n      color = ColorClass.colorNameMap[color];\n    }\n\n    if (color === 'transparent') {\n      source = [255, 255, 255, 0];\n    }\n\n    if (!source) {\n      source = ColorClass.sourceFromHex(color);\n    }\n    if (!source) {\n      source = ColorClass.sourceFromRgb(color);\n    }\n    if (!source) {\n      source = ColorClass.sourceFromHsl(color);\n    }\n    if (!source) {\n      source = [0, 0, 0, 1];\n    }\n    if (source) {\n      this.setSource(source);\n    }\n  }\n\n  _rgbToHsl(r, g, b) {\n    r /= 255;\n    g /= 255;\n    b /= 255;\n\n    let h, s, l,\n      max = max([r, g, b]),\n      min = min([r, g, b]);\n\n    l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0; // achromatic\n    } else {\n      let d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n      switch (max) {\n        case r:\n          h = (g - b) / d + (g < b ? 6 : 0);\n          break;\n        case g:\n          h = (b - r) / d + 2;\n          break;\n        case b:\n          h = (r - g) / d + 4;\n          break;\n      }\n      h /= 6;\n    }\n\n    return [\n      Math.round(h * 360),\n      Math.round(s * 100),\n      Math.round(l * 100)\n    ];\n  }\n\n  getSource() {\n    return this._source;\n  }\n\n  setSource(source) {\n    this._source = source;\n  }\n\n  toRgb() {\n    let source = this.getSource();\n    return 'rgb(' + source[0] + ',' + source[1] + ',' + source[2] + ')';\n  }\n\n  toRgba() {\n    let source = this.getSource();\n    return 'rgba(' + source[0] + ',' + source[1] + ',' + source[2] + ',' + source[3] + ')';\n  }\n\n  toHsl() {\n    let source = this.getSource(),\n      hsl = this._rgbToHsl(source[0], source[1], source[2]);\n\n    return 'hsl(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%)';\n  }\n\n  toHsla() {\n    let source = this.getSource(),\n      hsl = this._rgbToHsl(source[0], source[1], source[2]);\n\n    return 'hsla(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%,' + source[3] + ')';\n  }\n\n  toHex() {\n    let source = this.getSource(), r, g, b;\n\n    r = source[0].toString(16);\n    r = (r.length === 1) ? ('0' + r) : r;\n\n    g = source[1].toString(16);\n    g = (g.length === 1) ? ('0' + g) : g;\n\n    b = source[2].toString(16);\n    b = (b.length === 1) ? ('0' + b) : b;\n\n    return r.toUpperCase() + g.toUpperCase() + b.toUpperCase();\n  }\n\n  toHexa() {\n    let source = this.getSource(), a;\n\n    a = Math.round(source[3] * 255);\n    a = a.toString(16);\n    a = (a.length === 1) ? ('0' + a) : a;\n\n    return this.toHex() + a.toUpperCase();\n  }\n\n  getAlpha() {\n    return this.getSource()[3];\n  }\n\n  setAlpha(alpha) {\n    let source = this.getSource();\n    source[3] = alpha;\n    this.setSource(source);\n    return this;\n  }\n\n  toGrayscale() {\n    let source = this.getSource(),\n      average = parseInt((source[0] * 0.3 + source[1] * 0.59 + source[2] * 0.11).toFixed(0), 10),\n      currentAlpha = source[3];\n    this.setSource([average, average, average, currentAlpha]);\n    return this;\n  }\n\n  toBlackWhite(threshold) {\n    let source = this.getSource(),\n      average = (source[0] * 0.3 + source[1] * 0.59 + source[2] * 0.11).toFixed(0),\n      currentAlpha = source[3];\n\n    threshold = threshold || 127;\n\n    average = (Number(average) < Number(threshold)) ? 0 : 255;\n    this.setSource([average, average, average, currentAlpha]);\n    return this;\n  }\n\n  overlayWith(otherColor) {\n    if (!(otherColor instanceof Color)) {\n      otherColor = new ColorClass(otherColor);\n    }\n\n    let result = [],\n      alpha = this.getAlpha(),\n      otherAlpha = 0.5,\n      source = this.getSource(),\n      otherSource = otherColorClass.getSource(), i;\n\n    for (i = 0; i < 3; i++) {\n      result.push(Math.round((source[i] * (1 - otherAlpha)) + (otherSource[i] * otherAlpha)));\n    }\n\n    result[3] = alpha;\n    this.setSource(result);\n    return this;\n  }\n}\n\nColorClass.reRGBa = /^rgba?\\(\\s*(\\d{1,3}(?:\\.\\d+)?\\%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?\\%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?\\%?)\\s*(?:\\s*,\\s*((?:\\d*\\.?\\d+)?)\\s*)?\\)$/i;\n\nColorClass.reHSLa = /^hsla?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3}\\%)\\s*,\\s*(\\d{1,3}\\%)\\s*(?:\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*)?\\)$/i;\n\nColorClass.reHex = /^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i;\n\nColorClass.colorNameMap = {\n  aliceblue: '#F0F8FF',\n  antiquewhite: '#FAEBD7',\n  aqua: '#00FFFF',\n  aquamarine: '#7FFFD4',\n  azure: '#F0FFFF',\n  beige: '#F5F5DC',\n  bisque: '#FFE4C4',\n  black: '#000000',\n  blanchedalmond: '#FFEBCD',\n  blue: '#0000FF',\n  blueviolet: '#8A2BE2',\n  brown: '#A52A2A',\n  burlywood: '#DEB887',\n  cadetblue: '#5F9EA0',\n  chartreuse: '#7FFF00',\n  chocolate: '#D2691E',\n  coral: '#FF7F50',\n  cornflowerblue: '#6495ED',\n  cornsilk: '#FFF8DC',\n  crimson: '#DC143C',\n  cyan: '#00FFFF',\n  darkblue: '#00008B',\n  darkcyan: '#008B8B',\n  darkgoldenrod: '#B8860B',\n  darkgray: '#A9A9A9',\n  darkgrey: '#A9A9A9',\n  darkgreen: '#006400',\n  darkkhaki: '#BDB76B',\n  darkmagenta: '#8B008B',\n  darkolivegreen: '#556B2F',\n  darkorange: '#FF8C00',\n  darkorchid: '#9932CC',\n  darkred: '#8B0000',\n  darksalmon: '#E9967A',\n  darkseagreen: '#8FBC8F',\n  darkslateblue: '#483D8B',\n  darkslategray: '#2F4F4F',\n  darkslategrey: '#2F4F4F',\n  darkturquoise: '#00CED1',\n  darkviolet: '#9400D3',\n  deeppink: '#FF1493',\n  deepskyblue: '#00BFFF',\n  dimgray: '#696969',\n  dimgrey: '#696969',\n  dodgerblue: '#1E90FF',\n  firebrick: '#B22222',\n  floralwhite: '#FFFAF0',\n  forestgreen: '#228B22',\n  fuchsia: '#FF00FF',\n  gainsboro: '#DCDCDC',\n  ghostwhite: '#F8F8FF',\n  gold: '#FFD700',\n  goldenrod: '#DAA520',\n  gray: '#808080',\n  grey: '#808080',\n  green: '#008000',\n  greenyellow: '#ADFF2F',\n  honeydew: '#F0FFF0',\n  hotpink: '#FF69B4',\n  indianred: '#CD5C5C',\n  indigo: '#4B0082',\n  ivory: '#FFFFF0',\n  khaki: '#F0E68C',\n  lavender: '#E6E6FA',\n  lavenderblush: '#FFF0F5',\n  lawngreen: '#7CFC00',\n  lemonchiffon: '#FFFACD',\n  lightblue: '#ADD8E6',\n  lightcoral: '#F08080',\n  lightcyan: '#E0FFFF',\n  lightgoldenrodyellow: '#FAFAD2',\n  lightgray: '#D3D3D3',\n  lightgrey: '#D3D3D3',\n  lightgreen: '#90EE90',\n  lightpink: '#FFB6C1',\n  lightsalmon: '#FFA07A',\n  lightseagreen: '#20B2AA',\n  lightskyblue: '#87CEFA',\n  lightslategray: '#778899',\n  lightslategrey: '#778899',\n  lightsteelblue: '#B0C4DE',\n  lightyellow: '#FFFFE0',\n  lime: '#00FF00',\n  limegreen: '#32CD32',\n  linen: '#FAF0E6',\n  magenta: '#FF00FF',\n  maroon: '#800000',\n  mediumaquamarine: '#66CDAA',\n  mediumblue: '#0000CD',\n  mediumorchid: '#BA55D3',\n  mediumpurple: '#9370DB',\n  mediumseagreen: '#3CB371',\n  mediumslateblue: '#7B68EE',\n  mediumspringgreen: '#00FA9A',\n  mediumturquoise: '#48D1CC',\n  mediumvioletred: '#C71585',\n  midnightblue: '#191970',\n  mintcream: '#F5FFFA',\n  mistyrose: '#FFE4E1',\n  moccasin: '#FFE4B5',\n  navajowhite: '#FFDEAD',\n  navy: '#000080',\n  oldlace: '#FDF5E6',\n  olive: '#808000',\n  olivedrab: '#6B8E23',\n  orange: '#FFA500',\n  orangered: '#FF4500',\n  orchid: '#DA70D6',\n  palegoldenrod: '#EEE8AA',\n  palegreen: '#98FB98',\n  paleturquoise: '#AFEEEE',\n  palevioletred: '#DB7093',\n  papayawhip: '#FFEFD5',\n  peachpuff: '#FFDAB9',\n  peru: '#CD853F',\n  pink: '#FFC0CB',\n  plum: '#DDA0DD',\n  powderblue: '#B0E0E6',\n  purple: '#800080',\n  rebeccapurple: '#663399',\n  red: '#FF0000',\n  rosybrown: '#BC8F8F',\n  royalblue: '#4169E1',\n  saddlebrown: '#8B4513',\n  salmon: '#FA8072',\n  sandybrown: '#F4A460',\n  seagreen: '#2E8B57',\n  seashell: '#FFF5EE',\n  sienna: '#A0522D',\n  silver: '#C0C0C0',\n  skyblue: '#87CEEB',\n  slateblue: '#6A5ACD',\n  slategray: '#708090',\n  slategrey: '#708090',\n  snow: '#FFFAFA',\n  springgreen: '#00FF7F',\n  steelblue: '#4682B4',\n  tan: '#D2B48C',\n  teal: '#008080',\n  thistle: '#D8BFD8',\n  tomato: '#FF6347',\n  turquoise: '#40E0D0',\n  violet: '#EE82EE',\n  wheat: '#F5DEB3',\n  white: '#FFFFFF',\n  whitesmoke: '#F5F5F5',\n  yellow: '#FFFF00',\n  yellowgreen: '#9ACD32'\n};\n\n\nfunction hue2rgb(p, q, t) {\n  if (t < 0) {\n    t += 1;\n  }\n  if (t > 1) {\n    t -= 1;\n  }\n  if (t < 1 / 6) {\n    return p + (q - p) * 6 * t;\n  }\n  if (t < 1 / 2) {\n    return q;\n  }\n  if (t < 2 / 3) {\n    return p + (q - p) * (2 / 3 - t) * 6;\n  }\n  return p;\n}\n\nColorClass.fromRgb = function (color) {\n  return ColorClass.fromSource(ColorClass.sourceFromRgb(color));\n};\n\nColorClass.sourceFromRgb = function (color) {\n  let match = color.match(ColorClass.reRGBa);\n  if (match) {\n    let r = parseInt(match[1], 10) / (/%$/.test(match[1]) ? 100 : 1) * (/%$/.test(match[1]) ? 255 : 1),\n      g = parseInt(match[2], 10) / (/%$/.test(match[2]) ? 100 : 1) * (/%$/.test(match[2]) ? 255 : 1),\n      b = parseInt(match[3], 10) / (/%$/.test(match[3]) ? 100 : 1) * (/%$/.test(match[3]) ? 255 : 1);\n\n    return [\n      parseInt(r, 10),\n      parseInt(g, 10),\n      parseInt(b, 10),\n      match[4] ? parseFloat(match[4]) : 1\n    ];\n  }\n};\n\nColorClass.fromRgba = ColorClass.fromRgb;\n\nColorClass.fromHsl = function (color) {\n  return ColorClass.fromSource(ColorClass.sourceFromHsl(color));\n};\n\nColorClass.sourceFromHsl = function (color) {\n  let match = color.match(ColorClass.reHSLa);\n  if (!match) {\n    return;\n  }\n\n  let h = (((parseFloat(match[1]) % 360) + 360) % 360) / 360,\n    s = parseFloat(match[2]) / (/%$/.test(match[2]) ? 100 : 1),\n    l = parseFloat(match[3]) / (/%$/.test(match[3]) ? 100 : 1),\n    r, g, b;\n\n  if (s === 0) {\n    r = g = b = l;\n  } else {\n    let q = l <= 0.5 ? l * (s + 1) : l + s - l * s,\n      p = l * 2 - q;\n\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n\n  return [\n    Math.round(r * 255),\n    Math.round(g * 255),\n    Math.round(b * 255),\n    match[4] ? parseFloat(match[4]) : 1\n  ];\n};\n\nColorClass.fromHsla = ColorClass.fromHsl;\n\nColorClass.fromHex = function (color) {\n  return ColorClass.fromSource(ColorClass.sourceFromHex(color));\n};\n\nColorClass.sourceFromHex = function (color) {\n  if (color.match(ColorClass.reHex)) {\n    let value = color.slice(color.indexOf('#') + 1),\n      isShortNotation = (value.length === 3 || value.length === 4),\n      isRGBa = (value.length === 8 || value.length === 4),\n      r = isShortNotation ? (value.charAt(0) + value.charAt(0)) : value.substring(0, 2),\n      g = isShortNotation ? (value.charAt(1) + value.charAt(1)) : value.substring(2, 4),\n      b = isShortNotation ? (value.charAt(2) + value.charAt(2)) : value.substring(4, 6),\n      a = isRGBa ? (isShortNotation ? (value.charAt(3) + value.charAt(3)) : value.substring(6, 8)) : 'FF';\n\n    return [\n      parseInt(r, 16),\n      parseInt(g, 16),\n      parseInt(b, 16),\n      parseFloat((parseInt(a, 16) / 255).toFixed(2))\n    ];\n  }\n};\n\nColorClass.fromSource = function (source) {\n  let oColor = new Color();\n  oColorClass.setSource(source);\n  return oColor;\n};\n\nmodule.exports = ColorClass\n","/**\n * Created by Sugar on 2020/5/26.\n */\nconst ObjectClass = require('./shapes/object.class')\nconst {toFixed} = require('./utils/index')\nconst {populateWithProperties} = require('./utils/misc')\n\nclass PatternClass {\n  constructor(options) {\n    this.repeat = 'repeat'\n    this.offsetX = 0\n    this.offsetY = 0\n    this.initialize(options)\n  }\n\n\n  initialize(options, callback) {\n    options || (options = {});\n\n    this.id = ObjectClass.__uid++;\n    this.setOptions(options);\n    if (!options.source || (options.source && typeof options.source !== 'string')) {\n      callback && callback(this);\n      return;\n    } else {\n      // img src string\n      let _this = this;\n      // this.source = createImage();\n      // loadImage(options.source, function (img, isError) {\n      //   _this.source = img;\n      //   callback && callback(_this, isError);\n      // }, null, this.crossOrigin);\n    }\n  }\n\n  toObject(propertiesToInclude) {\n    let NUM_FRACTION_DIGITS = 2,\n      source, object;\n\n    // <img> element\n    if (typeof this.source.src === 'string') {\n      source = this.source.src;\n    }\n    // <canvas> element\n    else if (typeof this.source === 'object' && this.source.toDataURL) {\n      source = this.source.toDataURL();\n    }\n\n    object = {\n      type: 'pattern',\n      source: source,\n      repeat: this.repeat,\n      crossOrigin: this.crossOrigin,\n      offsetX: toFixed(this.offsetX, NUM_FRACTION_DIGITS),\n      offsetY: toFixed(this.offsetY, NUM_FRACTION_DIGITS),\n      patternTransform: this.patternTransform ? this.patternTransform.concat() : null\n    };\n    populateWithProperties(this, object, propertiesToInclude);\n\n    return object;\n  }\n\n  setOptions(options) {\n    for (let prop in options) {\n      this[prop] = options[prop];\n    }\n  }\n\n  /**\n   * 返回CanvasPattern的实例\n   * @param {CanvasContext} ctx\n   * @return {CanvasPattern}\n   */\n  toLive(ctx) {\n    let source = this.source;\n    if (!source) {\n      return '';\n    }\n\n    // 重复的图像源，支持代码包路径和本地临时路径 (本地路径)\n    if (typeof source.src !== 'undefined') {\n      if (!source.complete) {\n        return '';\n      }\n      if (source.naturalWidth === 0 || source.naturalHeight === 0) {\n        return '';\n      }\n    }\n\n    /**\n     * createPattern第二个参数 string repetition\n     repeat  水平竖直方向都重复\n     repeat-x  水平方向重复\n     repeat-y  竖直方向重复\n     no-repeat  不重复\n     */\n    return ctx.createPattern(source, this.repeat);\n  }\n}\n\nmodule.exports = PatternClass\n","/**\n * Created by Sugar on 2020/5/25.\n */\nconst CanvasClass = require('./canvas.class')\nconst ObjectClass = require('./shapes/object.class')\nconst ImageClass = require('./shapes/image.class')\nconst TextClass = require('./shapes/text.class')\nconst RectClass = require('./shapes/rect.class')\nconst PolygonClass = require('./shapes/polygon.class')\nconst TriangleClass = require('./shapes/triangle.class')\nconst CircleClass = require('./shapes/circle.class')\nconst EllipseClass = require('./shapes/ellipse.class')\nconst GradientClass = require('./gradient.class')\nconst PatternClass = require('./pattern.class')\nconst PointClass = require('./point.class')\nconst ColorClass = require('./color.class')\n\nconst {mergeMethods} = require('./utils/index')\nconst CommonMethods = require('./mixins/shared_methods.mixin')\nconst Observable = require('./mixins/observable.mixin')\nconst CanvasEvent = require('./mixins/canvas_events.mixin')\nconst ObjectOrigin = require('./mixins/object_origin.mixin')\nconst ObjectInteractivity = require('./mixins/object_interactivity.mixin')\nconst ObjectGeometry = require('./mixins/object_geometry.mixin')\nconst TextStyles = require('./mixins/text_style.mixin')\n\nconst Sugar = {}\n\nmergeMethods(CanvasClass, CommonMethods)\nmergeMethods(CanvasClass, Observable)\nmergeMethods(CanvasClass, CanvasEvent)\nmergeMethods(ObjectClass, CommonMethods)\nmergeMethods(ObjectClass, Observable)\nmergeMethods(ObjectClass, ObjectOrigin)\nmergeMethods(ObjectClass, ObjectInteractivity)\nmergeMethods(ObjectClass, ObjectGeometry)\nmergeMethods(TextClass, TextStyles)\n\nSugar.Canvas = CanvasClass\nSugar.Object = ObjectClass\nSugar.Image = ImageClass\nSugar.Text = TextClass\nSugar.Rect = RectClass\nSugar.Polygon = PolygonClass\nSugar.Triangle = TriangleClass\nSugar.Circle = CircleClass\nSugar.Ellipse = EllipseClass\nSugar.Gradient = GradientClass\nSugar.Pattern = PatternClass\nSugar.Point = PointClass\nSugar.Color = ColorClass\n\n\nmodule.exports = Sugar\n","/**\n * Created by Sugar on 2020/5/26.\n */\nconst {invertTransform, transformPoint, loadImage} = require('./utils/misc')\nconst PointClass = require('point.class')\nconst ImageClass = require('./shapes/image.class')\n\nclass CanvasClass {\n  constructor(options) {\n    let canvas = options.canvas\n    let ctx = canvas ? canvas.getContext('2d') : null\n    if (!canvas || !ctx) {\n      throw new Error(`请传入<canvas>组件节点`)\n    }\n    const dpr = wx.getSystemInfoSync().pixelRatio\n    canvas.width = options.width * dpr\n    canvas.height = options.height * dpr\n    ctx.scale(dpr, dpr)\n    this.ctx = ctx\n    this.canvas = canvas\n    this.dpr = dpr\n    // this.width = width\n    // this.height = height\n    // this._objects = []\n\n    this.backgroundImage = null // 画布实例的背景图像\n    this.backgroundColor = '' // 画布实例的背景颜色\n    this.overlayImage = null\n    this.overlayColor = ''\n\n    this.backgroundVpt = true\n    this.overlayVpt = true\n    this.controlsAboveOverlay = false // 是否在覆盖图像上方渲染对象\n\n    this.viewportTransform = [1, 0, 0, 1, 0, 0]\n    this.vptCoords = {} // 画布的四个角左边，属性为tl，tr，bl，br\n\n    this.preserveObjectStacking = false\n    this.allowTouchScrolling = true\n\n    this.initialize(options)\n  }\n\n  initialize(options) {\n    // this.renderAndResetBound = this.renderAndReset.bind(this);\n    this.requestRenderAllBound = this.requestRenderAll.bind(this)\n    this._initStatic(options)\n    this._initInteractive()\n  }\n\n  _initInteractive() {\n    this._currentTransform = null\n    this._groupSelector = null\n    // this._initEventListeners()\n\n    // this._initRetinaScaling()\n\n    // this.calcOffset()\n  }\n\n\n  /**\n   * @private\n   * @param {Object} [options] object\n   */\n  _initStatic(options) {\n    let cb = this.requestRenderAllBound\n    this._objects = []\n    this._initOptions(options);\n    if (options.backgroundImage) {\n      this.setBackgroundImage(options.backgroundImage, cb);\n    }\n    if (options.backgroundColor) {\n      this.setBackgroundColor(options.backgroundColor, cb)\n    }\n    // if (options.overlayImage) {\n    //   this.setOverlayImage(options.overlayImage, cb);\n    // }\n    // if (options.overlayColor) {\n    //   this.setOverlayColor(options.overlayColor, cb);\n    // }\n  }\n\n  _initOptions(options) {\n    this._setOptions(options);\n\n    this.width = this.width || 0;\n    this.height = this.height || 0;\n\n    this.viewportTransform = this.viewportTransform.slice();\n  }\n\n  _isRetinaScaling() {\n    return (this.dpr !== 1 && this.enableRetinaScaling);\n  }\n\n  getRetinaScaling() {\n    return this._isRetinaScaling() ? this.dpr : 1;\n  }\n\n  setBackgroundImage(image, callback, options) {\n    return this.__setBgOverlayImage('backgroundImage', image, callback, options)\n  }\n\n  setBackgroundColor(backgroundColor, callback) {\n    return this.__setBgOverlayColor('backgroundColor', backgroundColor, callback)\n  }\n\n  __setBgOverlayImage(property, image, callback, options) {\n    if (typeof image === 'string') {\n      loadImage(image, (img, isError) => {\n        console.log('设置背景图', img);\n        if (img) {\n          let instance = new ImageClass(img, options)\n          this[property] = instance\n          instance.canvas = this\n        }\n        callback && callback(img, isError)\n      }, this)\n    } else {\n      options && image.setOptions(options)\n      this[property] = image\n      image && (image.canvas = this)\n      callback && callback(image, false)\n    }\n\n    return this\n  }\n\n  __setBgOverlayColor(property, color, callback) {\n    this[property] = color\n    this._initGradient(color, property)\n    this._initPattern(color, property, callback)\n    return this\n  }\n\n  add() {\n    this._objects.push.apply(this._objects, arguments)\n    if (this._onObjectAdded) {\n      for (let i = 0; i < arguments.length; i++) {\n        this._onObjectAdded(arguments[i])\n      }\n    }\n    this.requestRenderAll()\n    return this\n  }\n\n  remove() {\n    let objects = this._objects\n    let index\n    let somethingRemoved = false\n\n    for (let i = 0; i < arguments.length; i++) {\n      index = objects.indexOf(arguments[i])\n\n      if (index !== -1) {\n        somethingRemoved = true\n        objects.splice(index, 1)\n        this._onObjectRemoved && this._onObjectRemoved(arguments[i])\n      }\n    }\n\n    somethingRemoved && this.requestRenderAll()\n    return this\n  }\n\n  _onObjectAdded(obj) {\n    // this.stateful && obj.setupState()\n    obj._set('canvas', this);\n    obj.setCoords();\n    this.fire('object:added', {target: obj})\n    obj.fire('added');\n  }\n\n  _onObjectRemoved(obj) {\n    if (obj === this._activeObject) {\n      this.fire('before:selection:cleared', {target: obj})\n      this._discardActiveObject()\n      this.fire('selection:cleared', {target: obj})\n      obj.fire('deselected');\n    }\n    this.fire('object:removed', {target: obj})\n    obj.fire('removed')\n    delete obj.canvas\n  }\n\n  /**\n   * 清除画布元素的指定上下文\n   * @param {CanvasContext} ctx 要清除的上下文\n   * @return {sugar.Canvas} thisArg\n   */\n  clearContext(ctx) {\n    ctx.clearRect(0, 0, this.width, this.height)\n    return this\n  }\n\n  /**\n   * 返回绘制对象的画布的上下文\n   * @return {CanvasContext}\n   */\n  getContext() {\n    return this.ctx\n  }\n\n  discardActiveObject(e) {\n    let currentActives = this.getActiveObjects(), activeObject = this.getActiveObject()\n    if (currentActives.length) {\n      this.fire('before:selection:cleared', {target: activeObject, e: e})\n    }\n    this._discardActiveObject(e)\n    this._fireSelectionEvents(currentActives, e)\n    return this\n  }\n\n  /**\n   * 清除实例的所有上下文（背景，主要内容等）\n   * @return {sugar.Canvas} thisArg\n   */\n  clear() {\n    this.discardActiveObject()\n    this._objects.length = 0\n    this.backgroundImage = null\n    this.backgroundColor = ''\n    this.clearContext(this.ctx)\n    // this.fire('canvas:cleared')\n    this.requestRenderAll()\n    return this\n  }\n\n  _shouldClearSelection(e, target) {\n    let activeObjects = this.getActiveObjects(),\n      activeObject = this._activeObject\n\n    return (\n      !target\n      ||\n      (target &&\n        activeObject &&\n        activeObjects.length > 1 &&\n        activeObjects.indexOf(target) === -1 &&\n        activeObject !== target)\n      ||\n      (target && !target.evented)\n      ||\n      (target &&\n        !target.selectable &&\n        activeObject &&\n        activeObject !== target)\n    )\n  }\n\n  _setupCurrentTransform(e, target, alreadySelected) {\n    if (!target) {\n      return;\n    }\n\n    let pointer = this.getPointer(e), corner = target.__corner,\n      // actionHandler = !!corner && target.controls[corner].getActionHandler(),\n      // action = this._getActionFromCorner(alreadySelected, corner, e, target),\n      // origin = this._getOriginFromCorner(target, corner),\n      transform = {\n        target: target,\n        // action: action,\n        action: 'drag',\n        // actionHandler: actionHandler,\n        corner: corner,\n        scaleX: target.scaleX,\n        scaleY: target.scaleY,\n        skewX: target.skewX,\n        skewY: target.skewY,\n        offsetX: pointer.x - target.left,\n        offsetY: pointer.y - target.top,\n        // originX: origin.x,\n        // originY: origin.y,\n        originX: target.originX,\n        originY: target.originY,\n        ex: pointer.x,\n        ey: pointer.y,\n        lastX: pointer.x,\n        lastY: pointer.y,\n        // theta: degreesToRadians(target.angle),\n        width: target.width * target.scaleX,\n      };\n\n    // if (this._shouldCenterTransform(target, action, altKey)) {\n    //   transform.originX = 'center';\n    //   transform.originY = 'center';\n    // }\n    // transform.original.originX = origin.x;\n    // transform.original.originY = origin.y;\n    this._currentTransform = transform;\n    this._beforeTransform(e);\n  }\n\n  _translateObject(x, y) {\n    let transform = this._currentTransform,\n      target = transform.target,\n      newLeft = x - transform.offsetX,\n      newTop = y - transform.offsetY,\n      moveX = !target.get('lockMovementX') && target.left !== newLeft,\n      moveY = !target.get('lockMovementY') && target.top !== newTop\n\n    moveX && target.set('left', newLeft)\n    moveY && target.set('top', newTop)\n    return moveX || moveY\n  }\n\n  /**\n   * 绘制对象的控件（边框/控件）\n   * @param {CanvasContext} ctx\n   */\n  drawControls(ctx) {\n    let activeObject = this._activeObject\n\n    if (activeObject) {\n      // console.log('drawControls, activeObject:', activeObject)\n      activeObject._renderControls(ctx)\n    }\n  }\n\n  getZoom() {\n    return this.viewportTransform[0];\n  }\n\n  /**\n   * 将renderAll请求追加到下一个动画帧\n   * 除非已经在进行中，否则就什么也不做\n   * @return {sugar.Canvas} instance\n   */\n  requestRenderAll() {\n    if (!this.isRendering) {\n      this.isRendering = this.canvas.requestAnimationFrame(() => {\n        this.isRendering = 0\n        this.renderAll()\n      })\n    }\n    return this\n  }\n\n  /**\n   * 使用当前视口计算画布4个角的位置\n   * @return {Object} points\n   */\n  calcViewportBoundaries() {\n    let points = {}, width = this.width, height = this.height,\n      iVpt = invertTransform(this.viewportTransform)\n    points.tl = transformPoint({x: 0, y: 0}, iVpt)\n    points.br = transformPoint({x: width, y: height}, iVpt)\n    points.tr = new PointClass(points.br.x, points.tl.y)\n    points.bl = new PointClass(points.tl.x, points.br.y)\n    this.vptCoords = points\n    return points\n  }\n\n  cancelRequestedRender() {\n    if (this.isRendering) {\n      this.canvas.cancelAnimationFrame(this.isRendering)\n      this.isRendering = 0\n    }\n  }\n\n  /**\n   * 渲染画布\n   * @return {sugar.Canvas} instance\n   */\n  renderAll() {\n    this.renderCanvas(this.ctx, this._chooseObjectsToRender())\n    return this\n  }\n\n  _chooseObjectsToRender() {\n    let activeObjects = this.getActiveObjects(),\n      object, objsToRender, activeGroupObjects\n\n    if (activeObjects.length > 0 && !this.preserveObjectStacking) {\n      objsToRender = []\n      activeGroupObjects = []\n      for (let i = 0; i < this._objects.length; i++) {\n        object = this._objects[i]\n        if (activeObjects.indexOf(object) === -1) {\n          objsToRender.push(object)\n        } else {\n          activeGroupObjects.push(object)\n        }\n      }\n      if (activeObjects.length > 1) {\n        this._activeObject._objects = activeGroupObjects\n      }\n      objsToRender.push.apply(objsToRender, activeGroupObjects)\n    } else {\n      objsToRender = this._objects\n    }\n    return objsToRender\n  }\n\n  /**\n   * 渲染背景，对象，叠加层和控件\n   * @param {CanvasContext} ctx\n   * @param {Array} objects 待渲染的图层对象\n   * @return {sugar.Canvas} instance\n   */\n  renderCanvas(ctx, objects) {\n    let v = this.viewportTransform\n    this.cancelRequestedRender()\n    this.calcViewportBoundaries()\n    this.clearContext(ctx)\n    // setImageSmoothing(ctx, this.imageSmoothingEnabled);\n    this.fire('before:render', {ctx: ctx,});\n    // console.log('before:render');\n    this._renderBackground(ctx);\n\n    ctx.save();\n    // 对所有渲染过程应用一次视口变换\n    ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5])\n    this._renderObjects(ctx, objects)\n    ctx.restore()\n    if (!this.controlsAboveOverlay) {\n      this.drawControls(ctx)\n    }\n    // this._renderOverlay(ctx)\n    if (this.controlsAboveOverlay) {\n      this.drawControls(ctx)\n    }\n    // console.log('renderCanvas after:render');\n    this.fire('after:render', {ctx: ctx,})\n  }\n\n  /**\n   * @private\n   * @param {CanvasContext} ctx\n   * @param {Array} objects\n   */\n  _renderObjects(ctx, objects) {\n    for (let i = 0; i < objects.length; i++) {\n      objects[i] && objects[i].render(ctx)\n    }\n  }\n\n  /**\n   * @private\n   * @param {CanvasContext} ctx\n   * @param {string} property 'background' 或 'overlay'\n   */\n  _renderBackgroundOrOverlay(ctx, property) {\n    let fill = this[property + 'Color']\n    let object = this[property + 'Image']\n    let v = this.viewportTransform\n    let needsVpt = this[property + 'Vpt']\n    if (!fill && !object) {\n      return\n    }\n    if (fill) {\n      ctx.save()\n      ctx.beginPath();\n      ctx.moveTo(0, 0)\n      ctx.lineTo(this.width, 0)\n      ctx.lineTo(this.width, this.height)\n      ctx.lineTo(0, this.height)\n      ctx.closePath()\n      ctx.fillStyle = fill.toLive ? fill.toLive(ctx, this) : fill\n      if (needsVpt) {\n        ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5])\n      }\n      ctx.transform(1, 0, 0, 1, fill.offsetX || 0, fill.offsetY || 0)\n      // let m = fill.gradientTransform || fill.patternTransform\n      // m && ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5])\n      ctx.fill()\n      ctx.restore()\n    }\n    if (object) {\n      ctx.save()\n      if (needsVpt) {\n        ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5])\n      }\n      object.render(ctx)\n      ctx.restore()\n    }\n  }\n\n  /**\n   * @private\n   * @param {CanvasContext} ctx\n   */\n  _renderBackground(ctx) {\n    this._renderBackgroundOrOverlay(ctx, 'background')\n  }\n\n  /**\n   * @private\n   * @param {CanvasContext} ctx\n   */\n  _renderOverlay(ctx) {\n    this._renderBackgroundOrOverlay(ctx, 'overlay')\n  }\n\n  /**\n   * 返回画布中心的坐标\n   * @return {Object} object 返回值是具有top和left属性的对象\n   */\n  getCenter() {\n    return {\n      top: this.height / 2,\n      left: this.width / 2\n    }\n  }\n\n  /**\n   * 返回当前选中操作的对象\n   * @return {sugar.Object}\n   */\n  getActiveObject() {\n    return this._activeObject\n  }\n\n  /**\n   * 返回具有当前所选操作的对象数组\n   * @return {sugar.Object} active object\n   */\n  getActiveObjects() {\n    let active = this._activeObject\n    if (active) {\n      if (active.type === 'activeSelection' && active._objects) {\n        return active._objects.slice(0)\n      } else {\n        return [active]\n      }\n    }\n    return []\n  }\n\n  /**\n   * 将一个对象在画布中设置为选中激活状态\n   * @param {sugar.Object} object 设为激活的对象\n   * @param {Event} [e] 事件（触发\"object:selected\"时传递）\n   * @return {sugar.Canvas}\n   */\n  setActiveObject(object, e) {\n    let currentActives = this.getActiveObjects()\n    this._setActiveObject(object, e)\n    this._fireSelectionEvents(currentActives, e)\n    return this;\n  }\n\n  /**\n   * @private\n   * @param {Object} object 设为激活的对象\n   * @param {Event} [e] 事件（触发\"object:selected\"时传递）\n   * @return {Boolean} 如果对象为选中激活状态，返回true\n   */\n  _setActiveObject(object, e) {\n    if (this._activeObject === object) {\n      // 当前对象已选中\n      return false\n    }\n    if (!this._discardActiveObject(e, object)) {\n      return false\n    }\n    if (object.onSelect({e: e})) {\n      return false\n    }\n    this._activeObject = object\n    return true\n  }\n\n  /**\n   * @private\n   */\n  _discardActiveObject(e, object) {\n    let obj = this._activeObject;\n    if (obj) {\n      if (obj.onDeselect({e: e, object: object})) {\n        return false\n      }\n      this._activeObject = null\n    }\n    return true\n  }\n\n  _fireSelectionEvents(oldObjects, e) {\n    let somethingChanged = false,\n      objects = this.getActiveObjects(),\n      added = [],\n      removed = [],\n      opt = {e: e}\n\n    oldObjects.forEach((oldObject) => {\n      if (objects.indexOf(oldObject) === -1) {\n        somethingChanged = true\n        oldObject.fire('deselected', opt)\n        removed.push(oldObject)\n      }\n    });\n    objects.forEach((object) => {\n      if (oldObjects.indexOf(object) === -1) {\n        somethingChanged = true\n        object.fire('selected', opt)\n        added.push(object)\n      }\n    });\n    if (oldObjects.length > 0 && objects.length > 0) {\n      opt.selected = added\n      opt.deselected = removed\n      opt.updated = added[0] || removed[0]\n      opt.target = this._activeObject\n      somethingChanged && this.fire('selection:updated', opt)\n    } else if (objects.length > 0) {\n      opt.selected = added\n      opt.target = this._activeObject\n      this.fire('selection:created', opt)\n    } else if (oldObjects.length > 0) {\n      opt.deselected = removed\n      this.fire('selection:cleared', opt)\n    }\n  }\n\n  toDataURL(options) {\n    try {\n      options || (options = {})\n\n      let format = options.format || 'jpeg'\n      let quality = options.quality || 0.5\n\n      /**\n       * toDataURL 微信基础库 2.11.0 开始支持\n       *\n       * string type\n       * 图片格式，默认为 image/png\n       *\n       * number encoderOptions\n       * 在指定图片格式为 image/jpeg 或 image/webp的情况下，可以从 0 到 1 的区间内选择图片的质量。如果超出取值范围，将会使用默认值 0.92。其他参数会被忽略。\n       */\n      return this.canvas.toDataURL(`image/${format}`, quality)\n    } catch (e) {\n      throw new Error('当前微信基础库不支持toDataURL，2.11.0开始支持')\n    }\n  }\n}\n\nmodule.exports = CanvasClass\n","/**\n * Created by Sugar on 2020/5/26.\n */\nconst ObjectClass = require('./object.class')\nconst {graphemeSplit} = require('../utils/string')\n\nclass TextClass extends ObjectClass {\n  constructor(text, options) {\n    super(options)\n\n    this.type = 'text'\n    this.stroke = null\n    this.fontSize = 16\n    this.fontWeight = 'normal'\n    this.fontFamily = 'sans-serif'\n    this.underline = false\n    this.overline = false\n    this.linethrough = false\n    this.textAlign = 'left'\n    this.fontStyle = 'normal'\n    this.lineHeight = 1.16\n    this.charSpacing = 0\n    this.styles = null\n    this._fontSizeMult = 1.13\n    this._fontSizeFraction = 0.222\n\n    this._reNewline = /\\r?\\n/\n    this._reSpaceAndTab = /[ \\t\\r]/\n    this._reSpacesAndTabs = /[ \\t\\r]/g\n\n    this.__charBounds = []\n    this.MIN_TEXT_WIDTH = 2\n    this.CACHE_FONT_SIZE = 400\n\n    this._styleProperties = [\n      'stroke',\n      'strokeWidth',\n      'fill',\n      'fontFamily',\n      'fontSize',\n      'fontWeight',\n      'fontStyle',\n      'underline',\n      'overline',\n      'linethrough',\n      // 'deltaY',\n      // 'textBackgroundColor',\n    ]\n    this._dimensionAffectingProps = [\n      'fontSize',\n      'fontWeight',\n      'fontFamily',\n      'fontStyle',\n      'lineHeight',\n      'text',\n      'charSpacing',\n      'textAlign',\n      'styles',\n    ]\n\n    this.initialize(text, options)\n  }\n\n  initialize(text, options) {\n    this.styles = options ? (options.styles || {}) : {}\n    this.text = text\n    super.initialize(options)\n    this.initDimensions();\n    this.setCoords();\n    // this.setupState({propertySet: '_dimensionAffectingProps'});\n  }\n\n  initDimensions() {\n    this._splitText();\n    this._clearCache();\n\n    if (this.canvas && this.canvas.ctx) {\n      // this.width = this.canvas.ctx.measureText(this.text).width || this.MIN_TEXT_WIDTH\n      this.width = this.calcTextWidth() || this.MIN_TEXT_WIDTH\n    }\n    this.height = this.calcTextHeight()\n    if (this.textAlign.indexOf('justify') !== -1) {\n      this.enlargeSpaces();\n    }\n    this.height = this.calcTextHeight();\n    // this.saveState({propertySet: '_dimensionAffectingProps'})\n  }\n\n  enlargeSpaces() {\n    let diffSpace, currentLineWidth, numberOfSpaces, accumulatedSpace, line, charBound, spaces;\n    for (let i = 0, len = this._textLines.length; i < len; i++) {\n      if (this.textAlign !== 'justify' && (i === len - 1 || this.isEndOfWrapping(i))) {\n        continue;\n      }\n      accumulatedSpace = 0;\n      line = this._textLines[i];\n      currentLineWidth = this.getLineWidth(i);\n      if (currentLineWidth < this.width && (spaces = this.textLines[i].match(this._reSpacesAndTabs))) {\n        numberOfSpaces = spaces.length;\n        diffSpace = (this.width - currentLineWidth) / numberOfSpaces;\n        for (let j = 0, jlen = line.length; j <= jlen; j++) {\n          charBound = this.__charBounds[i][j];\n          if (this._reSpaceAndTab.test(line[j])) {\n            charBound.width += diffSpace;\n            charBound.kernedWidth += diffSpace;\n            charBound.left += accumulatedSpace;\n            accumulatedSpace += diffSpace;\n          } else {\n            charBound.left += accumulatedSpace;\n          }\n        }\n      }\n    }\n  }\n\n  getFontCache(decl) {\n    let fontFamily = decl.fontFamily.toLowerCase();\n    if (!TextClass.charWidthsCache[fontFamily]) {\n      TextClass.charWidthsCache[fontFamily] = {};\n    }\n    let cache = TextClass.charWidthsCache[fontFamily],\n      cacheProp = decl.fontStyle.toLowerCase() + '_' + (decl.fontWeight + '').toLowerCase();\n    if (!cache[cacheProp]) {\n      cache[cacheProp] = {};\n    }\n    return cache[cacheProp];\n  }\n\n  calcTextHeight() {\n    let lineHeight, height = 0;\n    for (let i = 0, len = this._textLines.length; i < len; i++) {\n      lineHeight = this.getHeightOfLine(i);\n      height += (i === len - 1 ? lineHeight / this.lineHeight : lineHeight);\n    }\n    return height;\n  }\n\n  getHeightOfLine(lineIndex) {\n    if (this.__lineHeights[lineIndex]) {\n      return this.__lineHeights[lineIndex];\n    }\n\n    let line = this._textLines[lineIndex],\n      maxHeight = this.getHeightOfChar(lineIndex, 0);\n    for (let i = 1; i < line.length; i++) {\n      maxHeight = Math.max(this.getHeightOfChar(lineIndex, i), maxHeight);\n    }\n\n    return this.__lineHeights[lineIndex] = maxHeight * this.lineHeight * this._fontSizeMult;\n  }\n\n  getHeightOfChar(line, _char) {\n    return this.getValueOfPropertyAt(line, _char, 'fontSize');\n  }\n\n  getValueOfPropertyAt(lineIndex, charIndex, property) {\n    var charStyle = this._getStyleDeclaration(lineIndex, charIndex);\n    if (charStyle && typeof charStyle[property] !== 'undefined') {\n      return charStyle[property];\n    }\n    return this[property];\n  }\n\n  _clearCache() {\n    this.__lineWidths = []\n    this.__lineHeights = []\n    this.__charBounds = []\n  }\n\n  isEndOfWrapping(lineIndex) {\n    return lineIndex === this._textLines.length - 1;\n  }\n\n  missingNewlineOffset() {\n    return 1;\n  }\n\n  getMeasuringContext() {\n    let _measuringContext = this.canvas && this.canvas.ctx\n    return _measuringContext;\n  }\n\n  _splitText() {\n    let newLines = this._splitTextIntoLines(this.text)\n    this.textLines = newLines.lines\n    this._textLines = newLines.graphemeLines\n    this._unwrappedTextLines = newLines._unwrappedLines\n    this._text = newLines.graphemeText\n    return newLines\n  }\n\n  /**\n   * 返回分行后的文本数组.\n   * @param {String} text\n   * @returns {Array}\n   */\n  _splitTextIntoLines(text) {\n    let lines = text.split(this._reNewline),\n      newLines = new Array(lines.length),\n      newLine = ['\\n'],\n      newText = []\n    for (let i = 0; i < lines.length; i++) {\n      newLines[i] = graphemeSplit(lines[i])\n      newText = newText.concat(newLines[i], newLine)\n    }\n    newText.pop()\n    return {_unwrappedLines: newLines, lines: lines, graphemeText: newText, graphemeLines: newLines}\n  }\n\n  calcTextWidth() {\n    let maxWidth = this.getLineWidth(0);\n\n    for (let i = 1, len = this._textLines.length; i < len; i++) {\n      let currentLineWidth = this.getLineWidth(i);\n      if (currentLineWidth > maxWidth) {\n        maxWidth = currentLineWidth;\n      }\n    }\n    console.log('文本宽度', maxWidth)\n    return maxWidth;\n  }\n\n  getLineWidth(lineIndex) {\n    if (this.__lineWidths[lineIndex]) {\n      return this.__lineWidths[lineIndex];\n    }\n\n    let width, line = this._textLines[lineIndex], lineInfo;\n\n    if (line === '') {\n      width = 0;\n    } else {\n      lineInfo = this.measureLine(lineIndex);\n      width = lineInfo.width;\n    }\n    this.__lineWidths[lineIndex] = width;\n    return width;\n  }\n\n  measureLine(lineIndex) {\n    let lineInfo = this._measureLine(lineIndex);\n    if (this.charSpacing !== 0) {\n      lineInfo.width -= this._getWidthOfCharSpacing();\n    }\n    if (lineInfo.width < 0) {\n      lineInfo.width = 0;\n    }\n    return lineInfo;\n  }\n\n  _measureLine(lineIndex) {\n    let width = 0, i, grapheme, line = this._textLines[lineIndex], prevGrapheme,\n      graphemeInfo, numOfSpaces = 0, lineBounds = new Array(line.length);\n\n    this.__charBounds[lineIndex] = lineBounds;\n    for (i = 0; i < line.length; i++) {\n      grapheme = line[i];\n      graphemeInfo = this._getGraphemeBox(grapheme, lineIndex, i, prevGrapheme);\n      lineBounds[i] = graphemeInfo;\n      width += graphemeInfo.kernedWidth;\n      prevGrapheme = grapheme;\n    }\n    // this latest bound box represent the last character of the line\n    // to simplify cursor handling in interactive mode.\n    lineBounds[i] = {\n      left: graphemeInfo ? graphemeInfo.left + graphemeInfo.width : 0,\n      width: 0,\n      kernedWidth: 0,\n      height: this.fontSize\n    };\n    return {width: width, numOfSpaces: numOfSpaces};\n  }\n\n  _renderTextCommon(ctx, method) {\n    ctx.save();\n    let lineHeights = 0, left = this._getLeftOffset(ctx), top = this._getTopOffset(ctx),\n      offsets = this._applyPatternGradientTransform(ctx, method === 'fillText' ? this.fill : this.stroke);\n    for (let i = 0, len = this._textLines.length; i < len; i++) {\n      let heightOfLine = this.getHeightOfLine(i),\n        maxHeight = heightOfLine / this.lineHeight,\n        leftOffset = this._getLineLeftOffset(i);\n      this._renderTextLine(\n        method,\n        ctx,\n        this._textLines[i],\n        left + leftOffset - offsets.offsetX, // TODO 优化position\n        top + lineHeights + maxHeight - offsets.offsetY,\n        i\n      );\n      lineHeights += heightOfLine;\n    }\n    ctx.restore();\n  }\n\n  _getLeftOffset(ctx) {\n    // this.width = ctx.measureText(this.text).width || this.MIN_TEXT_WIDTH\n    return -this.width / 2;\n  }\n\n  _getTopOffset(ctx) {\n    return -this.height / 2;\n  }\n\n  _getLineLeftOffset(lineIndex) {\n    let lineWidth = this.getLineWidth(lineIndex);\n    if (this.textAlign === 'center') {\n      return (this.width - lineWidth) / 2;\n    }\n    if (this.textAlign === 'right') {\n      return this.width - lineWidth;\n    }\n    if (this.textAlign === 'justify-center' && this.isEndOfWrapping(lineIndex)) {\n      return (this.width - lineWidth) / 2;\n    }\n    if (this.textAlign === 'justify-right' && this.isEndOfWrapping(lineIndex)) {\n      return this.width - lineWidth;\n    }\n    return 0;\n  }\n\n  _getGraphemeBox(grapheme, lineIndex, charIndex, prevGrapheme, skipLeft) {\n    let style = this.getCompleteStyleDeclaration(lineIndex, charIndex),\n      prevStyle = prevGrapheme ? this.getCompleteStyleDeclaration(lineIndex, charIndex - 1) : {},\n      info = this._measureChar(grapheme, style, prevGrapheme, prevStyle),\n      kernedWidth = info.kernedWidth,\n      width = info.width, charSpacing;\n\n    if (this.charSpacing !== 0) {\n      charSpacing = this._getWidthOfCharSpacing();\n      width += charSpacing;\n      kernedWidth += charSpacing;\n    }\n\n    let box = {\n      width: width,\n      left: 0,\n      height: style.fontSize,\n      kernedWidth: kernedWidth,\n      deltaY: style.deltaY,\n    };\n    if (charIndex > 0 && !skipLeft) {\n      let previousBox = this.__charBounds[lineIndex][charIndex - 1];\n      box.left = previousBox.left + previousBox.width + info.kernedWidth - info.width;\n    }\n    return box;\n  }\n\n  _measureChar(_char, charStyle, previousChar, prevCharStyle) {\n    let fontCache = this.getFontCache(charStyle),\n      fontDeclaration = this._getFontDeclaration(charStyle),\n      previousFontDeclaration = this._getFontDeclaration(prevCharStyle), couple = previousChar + _char,\n      stylesAreEqual = fontDeclaration === previousFontDeclaration, width, coupleWidth, previousWidth,\n      fontMultiplier = charStyle.fontSize / this.CACHE_FONT_SIZE, kernedWidth;\n\n    if (previousChar && fontCache[previousChar] !== undefined) {\n      previousWidth = fontCache[previousChar];\n    }\n    if (fontCache[_char] !== undefined) {\n      kernedWidth = width = fontCache[_char];\n    }\n    if (stylesAreEqual && fontCache[couple] !== undefined) {\n      coupleWidth = fontCache[couple];\n      kernedWidth = coupleWidth - previousWidth;\n    }\n    let ctx\n    if (width === undefined || previousWidth === undefined || coupleWidth === undefined) {\n      ctx = this.getMeasuringContext();\n      this._setTextStyles(ctx, charStyle, true);\n    }\n    if (width === undefined) {\n      kernedWidth = width = ctx.measureText(_char).width;\n      fontCache[_char] = width;\n    }\n    if (previousWidth === undefined && stylesAreEqual && previousChar) {\n      previousWidth = ctx.measureText(previousChar).width;\n      fontCache[previousChar] = previousWidth;\n    }\n    if (stylesAreEqual && coupleWidth === undefined) {\n      coupleWidth = ctx.measureText(couple).width;\n      fontCache[couple] = coupleWidth;\n      kernedWidth = coupleWidth - previousWidth;\n    }\n    return {width: width * fontMultiplier, kernedWidth: kernedWidth * fontMultiplier};\n  }\n\n  _getFontDeclaration(styleObject, forMeasuring) {\n    // let style = styleObject || this, family = this.fontFamily,\n    //   fontIsGeneric = TextClass.genericFonts.indexOf(family.toLowerCase()) > -1;\n    // let fontFamily = family === undefined ||\n    // family.indexOf('\\'') > -1 || family.indexOf(',') > -1 ||\n    // family.indexOf('\"') > -1 || fontIsGeneric\n    //   ? style.fontFamily : '\"' + style.fontFamily + '\"';\n    // return [\n    //   style.fontStyle,\n    //   style.fontWeight,\n    //   forMeasuring ? this.CACHE_FONT_SIZE + 'px' : style.fontSize + 'px',\n    //   fontFamily\n    // ].join(' ');\n\n    return `${this.fontStyle} ${this.fontWeight} ${this.fontSize}px ${this.fontFamily}`\n  }\n\n  _getWidthOfCharSpacing() {\n    if (this.charSpacing !== 0) {\n      return this.fontSize * this.charSpacing / 1000;\n    }\n    return 0;\n  }\n\n  _setTextStyles(ctx, charStyle, forMeasuring) {\n    ctx.font = this._getFontDeclaration(charStyle, forMeasuring);\n    this.width = ctx.measureText(this.text).width || this.MIN_TEXT_WIDTH\n  }\n\n  _renderTextLinesBackground(ctx) {\n    if (!this.textBackgroundColor && !this.styleHas('textBackgroundColor')) {\n      return;\n    }\n    var lineTopOffset = 0, heightOfLine,\n      lineLeftOffset, originalFill = ctx.fillStyle,\n      line, lastColor,\n      leftOffset = this._getLeftOffset(ctx),\n      topOffset = this._getTopOffset(ctx),\n      boxStart = 0, boxWidth = 0, charBox, currentColor;\n\n    for (var i = 0, len = this._textLines.length; i < len; i++) {\n      heightOfLine = this.getHeightOfLine(i);\n      if (!this.textBackgroundColor && !this.styleHas('textBackgroundColor', i)) {\n        lineTopOffset += heightOfLine;\n        continue;\n      }\n      line = this._textLines[i];\n      lineLeftOffset = this._getLineLeftOffset(i);\n      boxWidth = 0;\n      boxStart = 0;\n      lastColor = this.getValueOfPropertyAt(i, 0, 'textBackgroundColor');\n      for (var j = 0, jlen = line.length; j < jlen; j++) {\n        charBox = this.__charBounds[i][j];\n        currentColor = this.getValueOfPropertyAt(i, j, 'textBackgroundColor');\n        if (currentColor !== lastColor) {\n          ctx.fillStyle = lastColor;\n          lastColor && ctx.fillRect(\n            leftOffset + lineLeftOffset + boxStart,\n            topOffset + lineTopOffset,\n            boxWidth,\n            heightOfLine / this.lineHeight\n          );\n          boxStart = charBox.left;\n          boxWidth = charBox.width;\n          lastColor = currentColor;\n        } else {\n          boxWidth += charBox.kernedWidth;\n        }\n      }\n      if (currentColor) {\n        ctx.fillStyle = currentColor;\n        ctx.fillRect(\n          leftOffset + lineLeftOffset + boxStart,\n          topOffset + lineTopOffset,\n          boxWidth,\n          heightOfLine / this.lineHeight\n        );\n      }\n      lineTopOffset += heightOfLine;\n    }\n    ctx.fillStyle = originalFill;\n\n    this._removeShadow(ctx);\n  }\n\n  _renderTextDecoration(ctx, type) {\n    if (!this[type] && !this.styleHas(type)) {\n      return;\n    }\n    var heightOfLine, size, _size,\n      lineLeftOffset, dy, _dy,\n      line, lastDecoration,\n      leftOffset = this._getLeftOffset(ctx),\n      topOffset = this._getTopOffset(ctx), top,\n      boxStart, boxWidth, charBox, currentDecoration,\n      maxHeight, currentFill, lastFill,\n      charSpacing = this._getWidthOfCharSpacing();\n\n    for (var i = 0, len = this._textLines.length; i < len; i++) {\n      heightOfLine = this.getHeightOfLine(i);\n      if (!this[type] && !this.styleHas(type, i)) {\n        topOffset += heightOfLine;\n        continue;\n      }\n      line = this._textLines[i];\n      maxHeight = heightOfLine / this.lineHeight;\n      lineLeftOffset = this._getLineLeftOffset(i);\n      boxStart = 0;\n      boxWidth = 0;\n      lastDecoration = this.getValueOfPropertyAt(i, 0, type);\n      lastFill = this.getValueOfPropertyAt(i, 0, 'fill');\n      top = topOffset + maxHeight * (1 - this._fontSizeFraction);\n      size = this.getHeightOfChar(i, 0);\n      dy = this.getValueOfPropertyAt(i, 0, 'deltaY');\n      for (var j = 0, jlen = line.length; j < jlen; j++) {\n        charBox = this.__charBounds[i][j];\n        currentDecoration = this.getValueOfPropertyAt(i, j, type);\n        currentFill = this.getValueOfPropertyAt(i, j, 'fill');\n        _size = this.getHeightOfChar(i, j);\n        _dy = this.getValueOfPropertyAt(i, j, 'deltaY');\n        if ((currentDecoration !== lastDecoration || currentFill !== lastFill || _size !== size || _dy !== dy) &&\n          boxWidth > 0) {\n          ctx.fillStyle = lastFill;\n          lastDecoration && lastFill && ctx.fillRect(\n            leftOffset + lineLeftOffset + boxStart,\n            top + this.offsets[type] * size + dy,\n            boxWidth,\n            this.fontSize / 15\n          );\n          boxStart = charBox.left;\n          boxWidth = charBox.width;\n          lastDecoration = currentDecoration;\n          lastFill = currentFill;\n          size = _size;\n          dy = _dy;\n        } else {\n          boxWidth += charBox.kernedWidth;\n        }\n      }\n      ctx.fillStyle = currentFill;\n      currentDecoration && currentFill && ctx.fillRect(\n        leftOffset + lineLeftOffset + boxStart,\n        top + this.offsets[type] * size + dy,\n        boxWidth - charSpacing,\n        this.fontSize / 15\n      );\n      topOffset += heightOfLine;\n    }\n    this._removeShadow(ctx);\n  }\n\n  _renderTextStroke(ctx) {\n    if ((!this.stroke || this.strokeWidth === 0) && this.isEmptyStyles()) {\n      return;\n    }\n\n    if (this.shadow && !this.shadow.affectStroke) {\n      this._removeShadow(ctx);\n    }\n\n    ctx.save();\n    this._setLineDash(ctx, this.strokeDashArray);\n    ctx.beginPath();\n    this._renderTextCommon(ctx, 'strokeText');\n    ctx.closePath();\n    ctx.restore();\n  }\n\n  _renderText(ctx) {\n    if (this.paintFirst === 'stroke') {\n      this._renderTextStroke(ctx);\n      this._renderTextFill(ctx);\n    } else {\n      this._renderTextFill(ctx);\n      this._renderTextStroke(ctx);\n    }\n  }\n\n  _renderTextFill(ctx) {\n    if (!this.fill && !this.styleHas('fill')) {\n      return;\n    }\n\n    this._renderTextCommon(ctx, 'fillText');\n  }\n\n  _renderTextLine(method, ctx, line, left, top, lineIndex) {\n    this._renderChars(method, ctx, line, left, top, lineIndex);\n  }\n\n  _renderChars(method, ctx, line, left, top, lineIndex) {\n    // set proper line offset\n    var lineHeight = this.getHeightOfLine(lineIndex),\n      isJustify = this.textAlign.indexOf('justify') !== -1,\n      actualStyle,\n      nextStyle,\n      charsToRender = '',\n      charBox,\n      boxWidth = 0,\n      timeToRender,\n      shortCut = !isJustify && this.charSpacing === 0 && this.isEmptyStyles(lineIndex);\n\n    ctx.save();\n    top -= lineHeight * this._fontSizeFraction / this.lineHeight;\n    if (shortCut) {\n      // render all the line in one pass without checking\n      this._renderChar(method, ctx, lineIndex, 0, this.textLines[lineIndex], left, top, lineHeight);\n      ctx.restore();\n      return;\n    }\n    for (var i = 0, len = line.length - 1; i <= len; i++) {\n      timeToRender = i === len || this.charSpacing;\n      charsToRender += line[i];\n      charBox = this.__charBounds[lineIndex][i];\n      if (boxWidth === 0) {\n        left += charBox.kernedWidth - charBox.width;\n        boxWidth += charBox.width;\n      } else {\n        boxWidth += charBox.kernedWidth;\n      }\n      if (isJustify && !timeToRender) {\n        if (this._reSpaceAndTab.test(line[i])) {\n          timeToRender = true;\n        }\n      }\n      if (!timeToRender) {\n        // if we have charSpacing, we render char by char\n        actualStyle = actualStyle || this.getCompleteStyleDeclaration(lineIndex, i);\n        nextStyle = this.getCompleteStyleDeclaration(lineIndex, i + 1);\n        timeToRender = this._hasStyleChanged(actualStyle, nextStyle);\n      }\n      if (timeToRender) {\n        this._renderChar(method, ctx, lineIndex, i, charsToRender, left, top, lineHeight);\n        charsToRender = '';\n        actualStyle = nextStyle;\n        left += boxWidth;\n        boxWidth = 0;\n      }\n    }\n    ctx.restore();\n  }\n\n  _renderChar(method, ctx, lineIndex, charIndex, _char, left, top) {\n    var decl = this._getStyleDeclaration(lineIndex, charIndex),\n      fullDecl = this.getCompleteStyleDeclaration(lineIndex, charIndex),\n      shouldFill = method === 'fillText' && fullDecl.fill,\n      shouldStroke = method === 'strokeText' && fullDecl.stroke && fullDecl.strokeWidth;\n\n    if (!shouldStroke && !shouldFill) {\n      return;\n    }\n    decl && ctx.save();\n\n    this._applyCharStyles(method, ctx, lineIndex, charIndex, fullDecl);\n\n    if (decl && decl.textBackgroundColor) {\n      this._removeShadow(ctx);\n    }\n    if (decl && decl.deltaY) {\n      top += decl.deltaY;\n    }\n    // console.log('ctx.fillText', _char, left, top)\n    shouldFill && ctx.fillText(_char, left, top);\n    shouldStroke && ctx.strokeText(_char, left, top);\n    decl && ctx.restore();\n  }\n\n  _applyCharStyles(method, ctx, lineIndex, charIndex, styleDeclaration) {\n    this._setFillStyles(ctx, styleDeclaration);\n    this._setStrokeStyles(ctx, styleDeclaration);\n    ctx.font = this._getFontDeclaration(styleDeclaration);\n  }\n\n  _hasStyleChanged(prevStyle, thisStyle) {\n    return prevStyle.fill !== thisStyle.fill ||\n      prevStyle.stroke !== thisStyle.stroke ||\n      prevStyle.strokeWidth !== thisStyle.strokeWidth ||\n      prevStyle.fontSize !== thisStyle.fontSize ||\n      prevStyle.fontFamily !== thisStyle.fontFamily ||\n      prevStyle.fontWeight !== thisStyle.fontWeight ||\n      prevStyle.fontStyle !== thisStyle.fontStyle ||\n      prevStyle.deltaY !== thisStyle.deltaY;\n  }\n\n  set(key, value) {\n    super.set(key, value)\n    let needsDims = false;\n    if (typeof key === 'object') {\n      for (let _key in key) {\n        needsDims = needsDims || this._dimensionAffectingProps.indexOf(_key) !== -1;\n      }\n    } else {\n      needsDims = this._dimensionAffectingProps.indexOf(key) !== -1;\n    }\n    if (needsDims) {\n      this.initDimensions();\n      this.setCoords();\n    }\n    return this;\n  }\n\n  _render(ctx) {\n    // console.log('_render绘制文字', ctx, this);\n    // ctx.save()\n    // // italic bold 20px cursive\n    // ctx.font = `${this.fontStyle} ${this.fontWeight} ${this.fontSize}px ${this.fontFamily}`\n    // this.width = ctx.measureText(this.text).width || this.MIN_TEXT_WIDTH\n    // ctx.fillStyle = this.fill\n    // // ctx.fillText(this.text, this.left, this.top + this.fontSize)\n    // ctx.fillText(this.text, this.left, this.top)\n    // // ctx.strokeText(this.text, this.left, this.top)\n    // ctx.restore();\n    this._setTextStyles(ctx);\n    this._renderTextLinesBackground(ctx);\n    this._renderTextDecoration(ctx, 'underline');\n    this._renderText(ctx);\n    this._renderTextDecoration(ctx, 'overline');\n    this._renderTextDecoration(ctx, 'linethrough');\n  }\n\n  render(ctx) {\n    if (!this.visible) {\n      return;\n    }\n    // if (this.canvas && this.canvas.skipOffscreen && !this.group && !this.isOnScreen()) {\n    //   return;\n    // }\n    // if (this._shouldClearDimensionCache()) {\n    // this.initDimensions();\n    // }\n    super.render(ctx)\n  }\n}\n\nTextClass.charWidthsCache = {}\nTextClass.genericFonts = ['sans-serif', 'serif', 'cursive', 'fantasy', 'monospace']\n\nmodule.exports = TextClass\n","/**\n * Created by Sugar on 2020/5/27.\n */\n\nfunction camelize(string) {\n  return string.replace(/-+(.)?/g, function (match, character) {\n    return character ? character.toUpperCase() : '';\n  });\n}\n\nfunction capitalize(string, firstLetterOnly) {\n  return string.charAt(0).toUpperCase() +\n    (firstLetterOnly ? string.slice(1) : string.slice(1).toLowerCase());\n}\n\nfunction escapeXml(string) {\n  return string.replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&apos;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;');\n}\n\nfunction graphemeSplit(textstring) {\n  var i = 0, chr, graphemes = [];\n  for (i = 0, chr; i < textstring.length; i++) {\n    if ((chr = getWholeChar(textstring, i)) === false) {\n      continue;\n    }\n    graphemes.push(chr);\n  }\n  return graphemes;\n}\n\nfunction getWholeChar(str, i) {\n  var code = str.charCodeAt(i);\n\n  if (isNaN(code)) {\n    return '';\n  }\n  if (code < 0xD800 || code > 0xDFFF) {\n    return str.charAt(i);\n  }\n\n  if (0xD800 <= code && code <= 0xDBFF) {\n    if (str.length <= (i + 1)) {\n      throw 'High surrogate without following low surrogate';\n    }\n    var next = str.charCodeAt(i + 1);\n    if (0xDC00 > next || next > 0xDFFF) {\n      throw 'High surrogate without following low surrogate';\n    }\n    return str.charAt(i) + str.charAt(i + 1);\n  }\n  if (i === 0) {\n    throw 'Low surrogate without preceding high surrogate';\n  }\n  var prev = str.charCodeAt(i - 1);\n\n  if (0xD800 > prev || prev > 0xDBFF) {\n    throw 'Low surrogate without preceding high surrogate';\n  }\n  return false;\n}\n\nmodule.exports = {\n  camelize,\n  capitalize,\n  escapeXml,\n  graphemeSplit\n}\n","/**\n * Created by Sugar on 2020/5/26.\n */\nconst ObjectClass = require('./object.class')\n\nclass RectClass extends ObjectClass {\n  constructor(options) {\n    super();\n    this.type = 'rect'\n    this.rx = 0\n    this.ry = 0\n\n    this.initialize(options)\n  }\n\n  initialize(options) {\n    super.initialize(options)\n    this._initRxRy()\n  }\n\n  _initRxRy() {\n    if (this.rx && !this.ry) {\n      this.ry = this.rx\n    } else if (this.ry && !this.rx) {\n      this.rx = this.ry\n    }\n  }\n\n  _render(ctx) {\n    console.log('绘制矩形', this)\n    let rx = this.rx ? Math.min(this.rx, this.width / 2) : 0,\n      ry = this.ry ? Math.min(this.ry, this.height / 2) : 0,\n      w = this.width,\n      h = this.height,\n      x = -this.width / 2,\n      y = -this.height / 2,\n      isRounded = rx !== 0 || ry !== 0,\n      k = 1 - 0.5522847498\n    ctx.beginPath()\n\n    ctx.moveTo(x + rx, y)\n\n    ctx.lineTo(x + w - rx, y)\n    isRounded && ctx.bezierCurveTo(x + w - k * rx, y, x + w, y + k * ry, x + w, y + ry)\n\n    ctx.lineTo(x + w, y + h - ry)\n    isRounded && ctx.bezierCurveTo(x + w, y + h - k * ry, x + w - k * rx, y + h, x + w - rx, y + h)\n\n    ctx.lineTo(x + rx, y + h)\n    isRounded && ctx.bezierCurveTo(x + k * rx, y + h, x, y + h - k * ry, x, y + h - ry)\n\n    ctx.lineTo(x, y + ry)\n    isRounded && ctx.bezierCurveTo(x, y + k * ry, x + k * rx, y, x + rx, y)\n\n    ctx.closePath()\n\n    this._renderPaintInOrder(ctx)\n  }\n}\n\nmodule.exports = RectClass\n","/**\n * Created by Sugar on 2020/6/7.\n */\nconst ObjectClass = require('./object.class')\nconst {\n  min,\n  max,\n} = require('../utils/index')\n\nclass PolygonClass extends ObjectClass {\n  constructor(points, options) {\n    super()\n\n    this.type = 'polygon'\n    this.points = null\n\n    this.initialize(points, options)\n  }\n\n  initialize(points, options) {\n    options = options || {}\n    this.points = points || []\n    super.initialize(options)\n    this._setPositionDimensions(options)\n  }\n\n  _setPositionDimensions(options) {\n    let calcDim = this._calcDimensions(options), correctLeftTop\n    this.width = calcDim.width\n    this.height = calcDim.height\n    if (!options.fromSVG) {\n      correctLeftTop = this.translateToGivenOrigin(\n        {x: calcDim.left - this.strokeWidth / 2, y: calcDim.top - this.strokeWidth / 2},\n        'left',\n        'top',\n        this.originX,\n        this.originY\n      )\n    }\n    if (typeof options.left === 'undefined') {\n      // this.left = options.fromSVG ? calcDim.left : correctLeftTop.x\n      this.left = correctLeftTop.x\n    }\n    if (typeof options.top === 'undefined') {\n      // this.top = options.fromSVG ? calcDim.top : correctLeftTop.y\n      this.top = correctLeftTop.y\n    }\n    this.pathOffset = {\n      x: calcDim.left + this.width / 2,\n      y: calcDim.top + this.height / 2\n    }\n  }\n\n  _calcDimensions() {\n    let points = this.points,\n      minX = min(points, 'x') || 0,\n      minY = min(points, 'y') || 0,\n      maxX = max(points, 'x') || 0,\n      maxY = max(points, 'y') || 0,\n      width = (maxX - minX),\n      height = (maxY - minY)\n\n    return {\n      left: minX,\n      top: minY,\n      width: width,\n      height: height\n    }\n  }\n\n  commonRender(ctx) {\n    let point, len = this.points.length,\n      x = this.pathOffset.x,\n      y = this.pathOffset.y\n\n    if (!len || isNaN(this.points[len - 1].y)) {\n      return false\n    }\n    ctx.beginPath()\n    ctx.moveTo(this.points[0].x - x, this.points[0].y - y)\n    for (let i = 0; i < len; i++) {\n      point = this.points[i]\n      ctx.lineTo(point.x - x, point.y - y)\n    }\n    return true\n  }\n\n  _render(ctx) {\n    if (!this.commonRender(ctx)) {\n      return;\n    }\n    ctx.closePath()\n    this._renderPaintInOrder(ctx)\n  }\n\n  complexity() {\n    return this.get('points').length\n  }\n}\n\nmodule.exports = PolygonClass\n","/**\n * Created by Sugar on 2020/6/6.\n */\nconst ObjectClass = require('./object.class')\n\nclass TriangleClass extends ObjectClass {\n  constructor(options) {\n    super()\n\n    this.type = 'triangle'\n    this.width = 50\n    this.height = 50\n\n    this.initialize(options)\n  }\n\n  initialize(options) {\n    super.initialize(options)\n  }\n\n  _render(ctx) {\n    let widthBy2 = this.width / 2\n    let heightBy2 = this.height / 2\n\n    ctx.beginPath()\n    ctx.moveTo(-widthBy2, heightBy2)\n    ctx.lineTo(0, -heightBy2)\n    ctx.lineTo(widthBy2, heightBy2)\n    ctx.closePath()\n\n    this._renderPaintInOrder(ctx)\n  }\n}\n\nmodule.exports = TriangleClass\n","/**\n * Created by Sugar on 2020/6/6.\n */\nconst ObjectClass = require('./object.class')\n\nconst pi = Math.PI\n\nclass CircleClass extends ObjectClass {\n  constructor(options) {\n    super()\n\n    this.type = 'circle'\n    this.radius = 0\n    this.startAngle = 0\n    this.endAngle = pi * 2\n\n    this.initialize(options)\n  }\n\n  initialize(options) {\n    super.initialize(options)\n  }\n\n  _set(key, value) {\n    super._set(key, value)\n\n    if (key === 'radius') {\n      this.setRadius(value)\n    }\n\n    return this\n  }\n\n  _render(ctx) {\n    ctx.beginPath()\n    ctx.arc(\n      0,\n      0,\n      this.radius,\n      this.startAngle,\n      this.endAngle, false)\n    this._renderPaintInOrder(ctx)\n  }\n\n  getRadiusX() {\n    return this.get('radius') * this.get('scaleX')\n  }\n\n  /**\n   * 返回对象的垂直半径（根据对象的缩放比例）\n   */\n  getRadiusY() {\n    return this.get('radius') * this.get('scaleY')\n  }\n\n  /**\n   * 设置对象的半径（并更新宽度）\n   */\n  setRadius(value) {\n    this.radius = value\n    return this.set('width', value * 2).set('height', value * 2)\n  }\n}\n\nmodule.exports = CircleClass\n","/**\n * Created by Sugar on 2020/6/6.\n */\nconst ObjectClass = require('./object.class')\n\nconst piBy2 = Math.PI * 2\n\nclass EllipseClass extends ObjectClass {\n  constructor(options) {\n    super()\n\n    this.type = 'ellipse'\n    this.rx = 0\n    this.ry = 0\n\n    this.initialize(options)\n  }\n\n  initialize(options) {\n    super.initialize(options)\n    this.set('rx', options && options.rx || 0)\n    this.set('ry', options && options.ry || 0)\n  }\n\n  _set(key, value) {\n    super._set(key, value)\n    switch (key) {\n      case 'rx':\n        this.rx = value\n        this.set('width', value * 2)\n        break;\n\n      case 'ry':\n        this.ry = value\n        this.set('height', value * 2)\n        break;\n\n    }\n    return this;\n  }\n\n  getRx() {\n    return this.get('rx') * this.get('scaleX')\n  }\n\n  getRy() {\n    return this.get('ry') * this.get('scaleY')\n  }\n\n  _render(ctx) {\n    ctx.beginPath()\n    ctx.save()\n    ctx.transform(1, 0, 0, this.ry / this.rx, 0, 0)\n    ctx.arc(\n      0,\n      0,\n      this.rx,\n      0,\n      piBy2,\n      false);\n    ctx.restore()\n    this._renderPaintInOrder(ctx)\n  }\n}\n\nmodule.exports = EllipseClass\n","/**\n * Created by Sugar on 2020/5/26.\n */\nconst Gradient = require('../gradient.class')\nconst Pattern = require('../pattern.class')\n\nmodule.exports = {\n  _setOptions: function (options) {\n    for (var prop in options) {\n      this.set(prop, options[prop]);\n    }\n  },\n\n  _initGradient: function (filler, property) {\n    if (filler && filler.colorStops && !(filler instanceof Gradient)) {\n      this.set(property, new Gradient(filler));\n    }\n  },\n\n  _initPattern: function (filler, property, callback) {\n    if (filler && filler.source && !(filler instanceof Pattern)) {\n      this.set(property, new Pattern(filler, callback));\n    } else {\n      callback && callback();\n    }\n  },\n\n  _setObject: function (obj) {\n    for (var prop in obj) {\n      this._set(prop, obj[prop]);\n    }\n  },\n\n  set: function (key, value) {\n    if (typeof key === 'object') {\n      this._setObject(key);\n    } else {\n      this._set(key, value);\n    }\n    return this;\n  },\n\n  _set: function (key, value) {\n    this[key] = value;\n  },\n\n  toggle: function (property) {\n    var value = this.get(property);\n    if (typeof value === 'boolean') {\n      this.set(property, !value);\n    }\n    return this;\n  },\n\n  get: function (property) {\n    return this[property];\n  }\n};\n","/**\n * Created by Sugar on 2020/5/28.\n */\nconst {fill} = require('../utils/index');\n\nconst _removeEventListener = function (eventName, handler) {\n  if (!this.__eventListeners[eventName]) {\n    return;\n  }\n  var eventListener = this.__eventListeners[eventName];\n  if (handler) {\n    eventListener[eventListener.indexOf(handler)] = false;\n  } else {\n    fill(eventListener, false);\n  }\n}\n\nconst on = function (eventName, handler) {\n  if (!this.__eventListeners) {\n    this.__eventListeners = {};\n  }\n  if (arguments.length === 1) {\n    for (var prop in eventName) {\n      this.on(prop, eventName[prop]);\n    }\n  } else {\n    if (!this.__eventListeners[eventName]) {\n      this.__eventListeners[eventName] = [];\n    }\n    this.__eventListeners[eventName].push(handler);\n  }\n  return this;\n}\n\nconst off = function (eventName, handler) {\n  if (!this.__eventListeners) {\n    return this;\n  }\n\n  if (arguments.length === 0) {\n    for (eventName in this.__eventListeners) {\n      _removeEventListener.call(this, eventName);\n    }\n  } else if (arguments.length === 1 && typeof arguments[0] === 'object') {\n    for (var prop in eventName) {\n      _removeEventListener.call(this, prop, eventName[prop]);\n    }\n  } else {\n    _removeEventListener.call(this, eventName, handler);\n  }\n  return this;\n}\n\nconst fire = function (eventName, options) {\n  if (!this.__eventListeners) {\n    return this;\n  }\n\n  var listenersForEvent = this.__eventListeners[eventName];\n  if (!listenersForEvent) {\n    return this;\n  }\n\n  for (var i = 0, len = listenersForEvent.length; i < len; i++) {\n    listenersForEvent[i] && listenersForEvent[i].call(this, options || {});\n  }\n  this.__eventListeners[eventName] = listenersForEvent.filter((value) => {\n    return value !== false;\n  });\n  return this;\n}\n\nmodule.exports = {\n  fire,\n  on,\n  off\n}\n","/**\n * Created by Sugar on 2020/5/30.\n */\nmodule.exports = {\n  /**\n   * @param e\n   * changedTouches: [\n   {identifier: 0\n     x: 188.0001220703125\n     y: 218.99996948242188\n     }\n   ],\n   currentTarget:{\n     dataset:{}\n     id: \"sugarjs\"\n     offsetLeft: 0\n     offsetTop: 0\n   }\n   target:{\n     dataset: {}\n     id: \"sugarjs\"\n     offsetLeft: 0\n     offsetTop: 0\n   }\n   timeStamp: 5821.974999998929\n   touches: [\n   {\n       identifier: 0\n       x: 188.0001220703125\n       y: 218.99996948242188\n     }\n   ],\n   type: \"touchstart\"\n   */\n  touchstart: function (e) {\n    this._target = null\n    this._handleEvent(e, 'start:before');\n    this._target = this._currentTransform ? this._currentTransform.target : this.findTarget(e) || null\n\n    var target = this._target\n    var pointer = this._pointer;\n    var shouldRender = this._shouldRender(target)\n\n    if (this._shouldClearSelection(e, target)) {\n      this.discardActiveObject(e)\n    }\n\n    if (target) {\n      var alreadySelected = target === this._activeObject;\n      if (target.selectable) {\n        console.log('点击目标', target)\n        this.setActiveObject(target, e);\n      }\n      // var corner = target._findTargetCorner(\n      //   this.getPointer(e, true),\n      //   true\n      // );\n      // target.__corner = corner;\n      if (target === this._activeObject) {\n        this._setupCurrentTransform(e, target, alreadySelected);\n      }\n    }\n    this._handleEvent(e, 'start');\n    (shouldRender) && this.requestRenderAll();\n  },\n  touchmove: function (e) {\n    if (!this.allowTouchScrolling) return\n    // console.log('move', e)\n\n    let target = this.findTarget(e)\n    if (e.touches && e.touches.length === 2) {\n      // 双指手势\n      if (target) {\n        // TODO 缩放、旋转\n        // this.__gesturesRenderer()\n        // this._handleEvent(e, 'gesture');\n      }\n      return\n    }\n    this._handleEvent(e, 'move:before');\n\n    if (!this._currentTransform) {\n      // target = this.findTarget(e) || null;\n      // this._setCursorFromEvent(e, target);\n      // this._fireOverOutEvents(target, e);\n    } else {\n      this._transformObject(e);\n    }\n    // console.log('移动目标', this._currentTransform)\n    this._handleEvent(e, 'move');\n    this._resetTransformEventData();\n  },\n  touchend: function (e) {\n    // console.log(e)\n    if (e.touches.length > 0) {\n      return\n    }\n    let target\n    // let transform = this._currentTransform\n    // let groupSelector = this._groupSelector\n    // let shouldRender = false\n    this._resetTransformEventData()\n    this._target = this._currentTransform ? this._currentTransform.target : this.findTarget(e) || null\n    target = this._target;\n    this._handleEvent(e, 'end:before');\n    // if (transform) {\n    // this._finalizeCurrentTransform(e);\n    // shouldRender = transform.actionPerformed;\n    // }\n    if (target) {\n      target.isMoving = false;\n    }\n    this._handleEvent(e, 'end');\n    // this._groupSelector = null;\n    this._currentTransform = null\n    // if (shouldRender) {\n    //   this.requestRenderAll();\n    // } else if (!isClick) {\n    //   this.renderTop();\n    // }\n    this._resetTransformEventData()\n  },\n  longtap: function (e) {\n\n  },\n  _handleEvent: function (e, eventType, button, isClick) {\n    var target = this._target,\n      targets = this.targets || [],\n      options = {\n        e: e,\n        target: target,\n        subTargets: targets,\n        // button: button || LEFT_CLICK,\n        // isClick: isClick || false,\n        // pointer: this._pointer,\n        // absolutePointer: this._absolutePointer,\n        transform: this._currentTransform\n      };\n    this.fire('touch:' + eventType, options);\n    target && target.fire('touch' + eventType, options);\n    for (var i = 0; i < targets.length; i++) {\n      targets[i].fire('touch' + eventType, options);\n    }\n  },\n  _shouldRender: function (target) {\n    var activeObject = this._activeObject;\n\n    if (\n      !!activeObject !== !!target ||\n      (activeObject && target && (activeObject !== target))\n    ) {\n      return true;\n    }\n    return false;\n  },\n\n  findTarget: function (e, skipGroup) {\n    if (this.skipTargetFind) {\n      return;\n    }\n    let ignoreZoom = true,\n      pointer = this.getPointer(e, ignoreZoom),\n      activeObject = this._activeObject,\n      aObjects = this.getActiveObjects(),\n      activeTarget, activeTargetSubs\n\n    this.targets = [];\n\n    if (aObjects.length > 1 && !skipGroup && activeObject === this._searchPossibleTargets([activeObject], pointer)) {\n      return activeObject;\n    }\n    if (aObjects.length === 1 && activeObject._findTargetCorner(pointer)) {\n      return activeObject;\n    }\n    if (aObjects.length === 1 &&\n      activeObject === this._searchPossibleTargets([activeObject], pointer)) {\n      if (!this.preserveObjectStacking) {\n        return activeObject;\n      } else {\n        activeTarget = activeObject;\n        activeTargetSubs = this.targets;\n        this.targets = [];\n      }\n    }\n    var target = this._searchPossibleTargets(this._objects, pointer);\n    if (e[this.altSelectionKey] && target && activeTarget && target !== activeTarget) {\n      target = activeTarget;\n      this.targets = activeTargetSubs;\n    }\n    return target;\n  },\n\n  _searchPossibleTargets: function (objects, pointer) {\n    var target, i = objects.length, subTarget;\n    while (i--) {\n      var objToCheck = objects[i];\n      // var pointerToUse = objToCheck.group && objToCheck.group.type !== 'activeSelection' ?\n      //   this._normalizePointer(objToCheck.group, pointer) : pointer;\n      if (this._checkTarget(pointer, objToCheck, pointer)) {\n        target = objects[i];\n        // if (target.subTargetCheck && target instanceof Group) {\n        //   subTarget = this._searchPossibleTargets(target._objects, pointer);\n        //   subTarget && this.targets.push(subTarget);\n        // }\n        break;\n      }\n    }\n    return target;\n  },\n\n  getPointer: function (e, ignoreZoom) {\n    if (this._pointer && ignoreZoom) {\n      return this._pointer;\n    }\n\n    let pointer = {\n      x: e.touches.length > 0 ? e.touches[0].x : e.changedTouches[0].x,\n      y: e.touches.length > 0 ? e.touches[0].y : e.changedTouches[0].y\n    }\n\n    return pointer\n  },\n\n  _checkTarget: function (pointer, obj, globalPointer) {\n    if (obj &&\n      obj.visible &&\n      obj.evented &&\n      this.containsPoint(null, obj, pointer)) {\n      // if ((this.perPixelTargetFind || obj.perPixelTargetFind) && !obj.isEditing) {\n      //   var isTransparent = this.isTargetTransparent(obj, globalPointer.x, globalPointer.y);\n      //   if (!isTransparent) {\n      //     return true;\n      //   }\n      // } else {\n      return true;\n      // }\n    }\n  },\n\n  containsPoint: function (e, target, point) {\n    var ignoreZoom = true,\n      pointer = point || this.getPointer(e, ignoreZoom),\n      xy;\n\n    // if (target.group && target.group === this._activeObject && target.group.type === 'activeSelection') {\n    //   xy = this._normalizePointer(target.group, pointer);\n    // } else {\n    xy = {x: pointer.x, y: pointer.y};\n    // }\n    // return (target.containsPoint(xy) || !!target._findTargetCorner(pointer, true));\n    return target.left <= xy.x && xy.x <= (target.left + target.width) && target.top <= xy.y && xy.y <= (target.top + target.height)\n  },\n\n  _transformObject: function (e) {\n    let pointer = this.getPointer(e),\n      transform = this._currentTransform;\n\n    transform.reset = false;\n    transform.target.isMoving = true;\n\n    this._performTransformAction(e, transform, pointer);\n    transform.actionPerformed && this.requestRenderAll();\n  },\n\n  _performTransformAction: function (e, transform, pointer) {\n    let x = pointer.x,\n      y = pointer.y,\n      action = transform.action,\n      actionPerformed = false,\n      options = {\n        target: transform.target,\n        e: e,\n        transform: transform,\n        pointer: pointer\n      };\n\n    if (action === 'drag') {\n      actionPerformed = this._translateObject(x, y);\n      if (actionPerformed) {\n        // this._fire('moving', options);\n        // this.setCursor(options.target.moveCursor || this.moveCursor);\n      }\n    }\n    transform.actionPerformed = transform.actionPerformed || actionPerformed;\n  },\n\n  _resetTransformEventData: function () {\n    this._target = null;\n    this._pointer = null;\n    this._absolutePointer = null;\n  },\n\n  _beforeTransform: function (e) {\n    let t = this._currentTransform;\n    // this.stateful && t.target.saveState();\n    this.fire('before:transform', {\n      e: e,\n      transform: t,\n    });\n  },\n  __gesturesParams: null,\n  __gesturesRenderer: function () {\n\n  }\n}\n","/**\n * Created by Sugar on 2020/5/30.\n */\nconst PointClass = require('../point.class')\nconst {degreesToRadians, cos, sin, rotatePoint} = require('../utils/misc')\nconst originXOffset = {\n  left: -0.5,\n  center: 0,\n  right: 0.5\n}\nconst originYOffset = {\n  top: -0.5,\n  center: 0,\n  bottom: 0.5\n}\n\nmodule.exports = {\n  translateToGivenOrigin: function (point, fromOriginX, fromOriginY, toOriginX, toOriginY) {\n    let x = point.x,\n      y = point.y,\n      offsetX, offsetY, dim;\n\n    if (typeof fromOriginX === 'string') {\n      fromOriginX = originXOffset[fromOriginX];\n    } else {\n      fromOriginX -= 0.5;\n    }\n\n    if (typeof toOriginX === 'string') {\n      toOriginX = originXOffset[toOriginX];\n    } else {\n      toOriginX -= 0.5;\n    }\n\n    offsetX = toOriginX - fromOriginX;\n\n    if (typeof fromOriginY === 'string') {\n      fromOriginY = originYOffset[fromOriginY];\n    } else {\n      fromOriginY -= 0.5;\n    }\n\n    if (typeof toOriginY === 'string') {\n      toOriginY = originYOffset[toOriginY];\n    } else {\n      toOriginY -= 0.5;\n    }\n\n    offsetY = toOriginY - fromOriginY;\n\n    if (offsetX || offsetY) {\n      dim = this._getTransformedDimensions();\n      x = point.x + offsetX * dim.x;\n      y = point.y + offsetY * dim.y;\n    }\n\n    return new PointClass(x, y);\n  },\n\n\n  translateToCenterPoint: function (point, originX, originY) {\n    let p = this.translateToGivenOrigin(point, originX, originY, 'center', 'center');\n    if (this.angle) {\n      return rotatePoint(p, point, degreesToRadians(this.angle));\n    }\n    return p;\n  },\n\n  /**\n   * Translates the coordinates from center to origin coordinates (based on the object's dimensions)\n   * @param {PointClass} center The point which corresponds to center of the object\n   * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n   * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n   * @return {PointClass}\n   */\n  translateToOriginPoint: function (center, originX, originY) {\n    let p = this.translateToGivenOrigin(center, 'center', 'center', originX, originY);\n    if (this.angle) {\n      return rotatePoint(p, center, degreesToRadians(this.angle));\n    }\n    return p;\n  },\n\n  /**\n   * Returns the real center coordinates of the object\n   * @return {PointClass}\n   */\n  getCenterPoint: function () {\n    let leftTop = new PointClass(this.left, this.top);\n    return this.translateToCenterPoint(leftTop, this.originX, this.originY);\n  },\n\n  /**\n   * Returns the coordinates of the object based on center coordinates\n   * @param {PointClass} point The point which corresponds to the originX and originY params\n   * @return {PointClass}\n   */\n  // getOriginPoint: function(center) {\n  //   return this.translateToOriginPoint(center, this.originX, this.originY);\n  // },\n\n  /**\n   * Returns the coordinates of the object as if it has a different origin\n   * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n   * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n   * @return {PointClass}\n   */\n  getPointByOrigin: function (originX, originY) {\n    let center = this.getCenterPoint();\n    return this.translateToOriginPoint(center, originX, originY);\n  },\n\n  /**\n   * Returns the point in local coordinates\n   * @param {PointClass} point The point relative to the global coordinate system\n   * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n   * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n   * @return {PointClass}\n   */\n  toLocalPoint: function (point, originX, originY) {\n    let center = this.getCenterPoint(),\n      p, p2;\n\n    if (typeof originX !== 'undefined' && typeof originY !== 'undefined') {\n      p = this.translateToGivenOrigin(center, 'center', 'center', originX, originY);\n    } else {\n      p = new PointClass(this.left, this.top);\n    }\n\n    p2 = new PointClass(point.x, point.y);\n    if (this.angle) {\n      p2 = rotatePoint(p2, center, -degreesToRadians(this.angle));\n    }\n    return p2.subtractEquals(p);\n  },\n\n  /**\n   * Returns the point in global coordinates\n   * @param {PointClass} The point relative to the local coordinate system\n   * @return {PointClass}\n   */\n  // toGlobalPoint: function(point) {\n  //   return rotatePoint(point, this.getCenterPoint(), degreesToRadians(this.angle)).addEquals(new PointClass(this.left, this.top));\n  // },\n\n  /**\n   * Sets the position of the object taking into consideration the object's origin\n   * @param {PointClass} pos The new position of the object\n   * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n   * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n   * @return {void}\n   */\n  setPositionByOrigin: function (pos, originX, originY) {\n    let center = this.translateToCenterPoint(pos, originX, originY),\n      position = this.translateToOriginPoint(center, this.originX, this.originY);\n    this.set('left', position.x);\n    this.set('top', position.y);\n  },\n\n  /**\n   * @param {String} to One of 'left', 'center', 'right'\n   */\n  adjustPosition: function (to) {\n    let angle = degreesToRadians(this.angle),\n      hypotFull = this.getScaledWidth(),\n      xFull = cos(angle) * hypotFull,\n      yFull = sin(angle) * hypotFull,\n      offsetFrom, offsetTo;\n\n    //TODO: this function does not consider mixed situation like top, center.\n    if (typeof this.originX === 'string') {\n      offsetFrom = originXOffset[this.originX];\n    } else {\n      offsetFrom = this.originX - 0.5;\n    }\n    if (typeof to === 'string') {\n      offsetTo = originXOffset[to];\n    } else {\n      offsetTo = to - 0.5;\n    }\n    this.left += xFull * (offsetTo - offsetFrom);\n    this.top += yFull * (offsetTo - offsetFrom);\n    this.setCoords();\n    this.originX = to;\n  },\n\n  /**\n   * Sets the origin/position of the object to it's center point\n   * @private\n   * @return {void}\n   */\n  _setOriginToCenter: function () {\n    this._originalOriginX = this.originX;\n    this._originalOriginY = this.originY;\n\n    let center = this.getCenterPoint();\n\n    this.originX = 'center';\n    this.originY = 'center';\n\n    this.left = center.x;\n    this.top = center.y;\n  },\n\n  /**\n   * Resets the origin/position of the object to it's original origin\n   * @private\n   * @return {void}\n   */\n  _resetOrigin: function () {\n    let originPoint = this.translateToOriginPoint(\n      this.getCenterPoint(),\n      this._originalOriginX,\n      this._originalOriginY);\n\n    this.originX = this._originalOriginX;\n    this.originY = this._originalOriginY;\n\n    this.left = originPoint.x;\n    this.top = originPoint.y;\n\n    this._originalOriginX = null;\n    this._originalOriginY = null;\n  },\n\n  /**\n   * @private\n   */\n  _getLeftTopCoords: function () {\n    return this.translateToOriginPoint(this.getCenterPoint(), 'left', 'top');\n  },\n}\n","/**\n * Created by Sugar on 2020/5/30.\n */\n\nconst {degreesToRadians, cos, sin, sizeAfterTransform} = require('../utils/misc')\n\nmodule.exports = {\n  /**\n   * 确定点击哪个角\n   * @private\n   * @param {Object} pointer 触摸指针\n   * @return {String|Boolean}\n   */\n  _findTargetCorner: function (pointer, forTouch) {\n    if (!this.hasControls || this.group || (!this.canvas || this.canvas._activeObject !== this)) {\n      return false;\n    }\n\n    let ex = pointer.x,\n      ey = pointer.y,\n      xPoints,\n      lines, keys = Object.keys(this.oCoords),\n      j = keys.length - 1, i;\n    this.__corner = 0;\n\n    for (; j >= 0; j--) {\n      i = keys[j];\n      if (!this.isControlVisible(i)) {\n        continue;\n      }\n\n      lines = this._getImageLines(forTouch ? this.oCoords[i].touchCorner : this.oCoords[i].corner);\n\n      xPoints = this._findCrossPoints({x: ex, y: ey}, lines);\n      if (xPoints !== 0 && xPoints % 2 === 1) {\n        this.__corner = i;\n        return i;\n      }\n    }\n    return false;\n  },\n\n  forEachControl: function (fn) {\n    for (let i in this.controls) {\n      fn(this.controls[i], i, this);\n    }\n  },\n\n  /**\n   * @private\n   */\n  _setCornerCoords: function () {\n    let coords = this.oCoords,\n      newTheta = degreesToRadians(45 - this.angle),\n      cosTheta = cos(newTheta),\n      sinTheta = sin(newTheta),\n      /* Math.sqrt(2 * Math.pow(this.cornerSize, 2)) / 2, */\n      /* 0.707106 stands for sqrt(2)/2 */\n      cornerHypotenuse = this.cornerSize * 0.707106,\n      touchHypotenuse = this.touchCornerSize * 0.707106,\n      cosHalfOffset = cornerHypotenuse * cosTheta,\n      sinHalfOffset = cornerHypotenuse * sinTheta,\n      touchCosHalfOffset = touchHypotenuse * cosTheta,\n      touchSinHalfOffset = touchHypotenuse * sinTheta,\n      x, y;\n\n    for (let control in coords) {\n      x = coords[control].x;\n      y = coords[control].y;\n      coords[control].corner = {\n        tl: {\n          x: x - sinHalfOffset,\n          y: y - cosHalfOffset\n        },\n        tr: {\n          x: x + cosHalfOffset,\n          y: y - sinHalfOffset\n        },\n        bl: {\n          x: x - cosHalfOffset,\n          y: y + sinHalfOffset\n        },\n        br: {\n          x: x + sinHalfOffset,\n          y: y + cosHalfOffset\n        }\n      };\n      coords[control].touchCorner = {\n        tl: {\n          x: x - touchSinHalfOffset,\n          y: y - touchCosHalfOffset\n        },\n        tr: {\n          x: x + touchCosHalfOffset,\n          y: y - touchSinHalfOffset\n        },\n        bl: {\n          x: x - touchCosHalfOffset,\n          y: y + touchSinHalfOffset\n        },\n        br: {\n          x: x + touchSinHalfOffset,\n          y: y + touchCosHalfOffset\n        }\n      };\n    }\n  },\n\n  drawSelectionBackground: function (ctx) {\n    if (!this.selectionBackgroundColor ||\n      (this.canvas && !this.canvas.interactive) ||\n      (this.canvas && this.canvas._activeObject !== this)\n    ) {\n      return this;\n    }\n    ctx.save();\n    let center = this.getCenterPoint(), wh = this._calculateCurrentDimensions(),\n      vpt = this.canvas.viewportTransform;\n    ctx.translate(center.x, center.y);\n    ctx.scale(1 / vpt[0], 1 / vpt[3]);\n    ctx.rotate(degreesToRadians(this.angle));\n    ctx.fillStyle = this.selectionBackgroundColor;\n    ctx.fillRect(-wh.x / 2, -wh.y / 2, wh.x, wh.y);\n    ctx.restore();\n    return this;\n  },\n\n  drawBorders: function (ctx, styleOverride) {\n    styleOverride = styleOverride || {};\n    let wh = this._calculateCurrentDimensions(),\n      strokeWidth = this.borderScaleFactor,\n      width = wh.x + strokeWidth,\n      height = wh.y + strokeWidth,\n      hasControls = typeof styleOverride.hasControls !== 'undefined' ?\n        styleOverride.hasControls : this.hasControls,\n      shouldStroke = false;\n\n    ctx.save();\n    ctx.strokeStyle = styleOverride.borderColor || this.borderColor;\n    this._setLineDash(ctx, styleOverride.borderDashArray || this.borderDashArray, null);\n    // console.log('---------drawBorders', this.left, this.top)\n    ctx.strokeRect(\n      -width / 2,\n      -height / 2,\n      // this.left,\n      // this.top,\n      width,\n      height\n    );\n\n    if (hasControls) {\n      ctx.beginPath();\n      this.forEachControl(function (control, key, object) {\n        if (control.withConnection && control.getVisibility(object, key)) {\n          // reset movement for each control\n          shouldStroke = true;\n          ctx.moveTo(control.x * width, control.y * height);\n          ctx.lineTo(\n            control.x * width + control.offsetX,\n            control.y * height + control.offsetY\n          );\n        }\n      });\n      if (shouldStroke) {\n        ctx.stroke();\n      }\n    }\n    ctx.restore();\n    return this;\n  },\n\n  drawBordersInGroup: function (ctx, options, styleOverride) {\n    styleOverride = styleOverride || {};\n    var bbox = sizeAfterTransform(this.width, this.height, options),\n      strokeWidth = this.strokeWidth,\n      strokeUniform = this.strokeUniform,\n      borderScaleFactor = this.borderScaleFactor,\n      width =\n        bbox.x + strokeWidth * (strokeUniform ? this.canvas.getZoom() : options.scaleX) + borderScaleFactor,\n      height =\n        bbox.y + strokeWidth * (strokeUniform ? this.canvas.getZoom() : options.scaleY) + borderScaleFactor;\n    ctx.save();\n    this._setLineDash(ctx, styleOverride.borderDashArray || this.borderDashArray, null);\n    ctx.strokeStyle = styleOverride.borderColor || this.borderColor;\n    ctx.strokeRect(\n      -width / 2,\n      -height / 2,\n      // this.left,\n      // this.top,\n      width,\n      height\n    );\n\n    ctx.restore();\n    return this;\n  },\n\n  drawControls: function (ctx, styleOverride) {\n    styleOverride = styleOverride || {};\n    ctx.save();\n    ctx.setTransform(this.canvas.getRetinaScaling(), 0, 0, this.canvas.getRetinaScaling(), 0, 0);\n    ctx.strokeStyle = ctx.fillStyle = styleOverride.cornerColor || this.cornerColor;\n    if (!this.transparentCorners) {\n      ctx.strokeStyle = styleOverride.cornerStrokeColor || this.cornerStrokeColor;\n    }\n    this._setLineDash(ctx, styleOverride.cornerDashArray || this.cornerDashArray, null);\n    this.setCoords();\n    this.forEachControl(function (control, key, object) {\n      if (control.getVisibility(object, key)) {\n        control.render(ctx,\n          object.oCoords[key].x,\n          object.oCoords[key].y, styleOverride, object);\n      }\n    });\n    ctx.restore();\n\n    return this;\n  },\n\n  isControlVisible: function (controlKey) {\n    return this.controls[controlKey] && this.controls[controlKey].getVisibility(this, controlKey);\n  },\n\n  setControlVisible: function (controlKey, visible) {\n    if (!this._controlsVisibility) {\n      this._controlsVisibility = {};\n    }\n    this._controlsVisibility[controlKey] = visible;\n    return this;\n  },\n\n  setControlsVisibility: function (options) {\n    options || (options = {});\n\n    for (let p in options) {\n      this.setControlVisible(p, options[p]);\n    }\n    return this;\n  },\n\n\n  onDeselect: function () {\n  },\n\n  onSelect: function () {\n  }\n}\n","/**\n * Created by Sugar on 2020/5/30.\n */\n\nconst PointClass = require('../point.class')\nconst IntersectionClass = require('../intersection.class')\nconst {\n  degreesToRadians,\n  multiplyTransformMatrices,\n  transformPoint,\n  calcDimensionsMatrix,\n  sizeAfterTransform,\n  makeBoundingBoxFromPoints,\n  cos, sin,\n  calcRotateMatrix,\n  composeMatrix,\n} = require('../utils/misc')\n\nfunction arrayFromCoords(coords) {\n  return [\n    new PointClass(coords.tl.x, coords.tl.y),\n    new PointClass(coords.tr.x, coords.tr.y),\n    new PointClass(coords.br.x, coords.br.y),\n    new PointClass(coords.bl.x, coords.bl.y)\n  ];\n}\n\n\nmodule.exports = {\n  oCoords: null,\n  aCoords: null,\n  lineCoords: null,\n  ownMatrixCache: null,\n  matrixCache: null,\n  controls: {},\n  _getCoords: function (absolute, calculate) {\n    if (calculate) {\n      return (absolute ? this.calcACoords() : this.calcLineCoords());\n    }\n    if (!this.aCoords || !this.lineCoords) {\n      this.setCoords(true);\n    }\n    return (absolute ? this.aCoords : this.lineCoords);\n  },\n\n  getCoords: function (absolute, calculate) {\n    return arrayFromCoords(this._getCoords(absolute, calculate));\n  },\n\n  intersectsWithRect: function (pointTL, pointBR, absolute, calculate) {\n    let coords = this.getCoords(absolute, calculate),\n      intersection = IntersectionClass.intersectPolygonRectangle(\n        coords,\n        pointTL,\n        pointBR\n      );\n    return intersection.status === 'Intersection';\n  },\n\n  intersectsWithObject: function (other, absolute, calculate) {\n    let intersection = IntersectionClass.intersectPolygonPolygon(\n      this.getCoords(absolute, calculate),\n      other.getCoords(absolute, calculate)\n    );\n\n    return intersection.status === 'Intersection'\n      || other.isContainedWithinObject(this, absolute, calculate)\n      || this.isContainedWithinObject(other, absolute, calculate);\n  },\n\n  isContainedWithinObject: function (other, absolute, calculate) {\n    let points = this.getCoords(absolute, calculate),\n      otherCoords = absolute ? other.aCoords : other.lineCoords,\n      i = 0, lines = other._getImageLines(otherCoords);\n    for (; i < 4; i++) {\n      if (!other.containsPoint(points[i], lines)) {\n        return false;\n      }\n    }\n    return true;\n  },\n\n  isContainedWithinRect: function (pointTL, pointBR, absolute, calculate) {\n    let boundingRect = this.getBoundingRect(absolute, calculate);\n\n    return (\n      boundingRect.left >= pointTL.x &&\n      boundingRect.left + boundingRect.width <= pointBR.x &&\n      boundingRect.top >= pointTL.y &&\n      boundingRect.top + boundingRect.height <= pointBR.y\n    );\n  },\n\n  containsPoint: function (point, lines, absolute, calculate) {\n    let coords = this._getCoords(absolute, calculate);\n    let l = lines || this._getImageLines(coords);\n    let xPoints = this._findCrossPoints(point, l);\n    return (xPoints !== 0 && xPoints % 2 === 1);\n  },\n\n  isOnScreen: function (calculate) {\n    if (!this.canvas) {\n      return false;\n    }\n    let pointTL = this.canvas.vptCoords.tl, pointBR = this.canvas.vptCoords.br;\n    let points = this.getCoords(true, calculate), point;\n    for (let i = 0; i < 4; i++) {\n      point = points[i];\n      if (point.x <= pointBR.x && point.x >= pointTL.x && point.y <= pointBR.y && point.y >= pointTL.y) {\n        return true;\n      }\n    }\n    // no points on screen, check intersection with absolute coordinates\n    if (this.intersectsWithRect(pointTL, pointBR, true, calculate)) {\n      return true;\n    }\n    return this._containsCenterOfCanvas(pointTL, pointBR, calculate);\n  },\n\n  _containsCenterOfCanvas: function (pointTL, pointBR, calculate) {\n    // worst case scenario the object is so big that contains the screen\n    let centerPoint = {x: (pointTL.x + pointBR.x) / 2, y: (pointTL.y + pointBR.y) / 2};\n    if (this.containsPoint(centerPoint, null, true, calculate)) {\n      return true;\n    }\n    return false;\n  },\n\n  isPartiallyOnScreen: function (calculate) {\n    if (!this.canvas) {\n      return false;\n    }\n    let pointTL = this.canvas.vptCoords.tl, pointBR = this.canvas.vptCoords.br;\n    if (this.intersectsWithRect(pointTL, pointBR, true, calculate)) {\n      return true;\n    }\n    return this._containsCenterOfCanvas(pointTL, pointBR, calculate);\n  },\n\n  _getImageLines: function (oCoords) {\n\n    let lines = {\n      topline: {\n        o: oCoords.tl,\n        d: oCoords.tr\n      },\n      rightline: {\n        o: oCoords.tr,\n        d: oCoords.br\n      },\n      bottomline: {\n        o: oCoords.br,\n        d: oCoords.bl\n      },\n      leftline: {\n        o: oCoords.bl,\n        d: oCoords.tl\n      }\n    };\n\n    // // debugging\n    // if (this.canvas.contextTop) {\n    //   this.canvas.contextTop.fillRect(lines.bottomline.d.x, lines.bottomline.d.y, 2, 2);\n    //   this.canvas.contextTop.fillRect(lines.bottomline.o.x, lines.bottomline.o.y, 2, 2);\n    //\n    //   this.canvas.contextTop.fillRect(lines.leftline.d.x, lines.leftline.d.y, 2, 2);\n    //   this.canvas.contextTop.fillRect(lines.leftline.o.x, lines.leftline.o.y, 2, 2);\n    //\n    //   this.canvas.contextTop.fillRect(lines.topline.d.x, lines.topline.d.y, 2, 2);\n    //   this.canvas.contextTop.fillRect(lines.topline.o.x, lines.topline.o.y, 2, 2);\n    //\n    //   this.canvas.contextTop.fillRect(lines.rightline.d.x, lines.rightline.d.y, 2, 2);\n    //   this.canvas.contextTop.fillRect(lines.rightline.o.x, lines.rightline.o.y, 2, 2);\n    // }\n\n    return lines;\n  },\n\n  _findCrossPoints: function (point, lines) {\n    let b1, b2, a1, a2, xi, // yi,\n      xcount = 0,\n      iLine;\n\n    for (let lineKey in lines) {\n      iLine = lines[lineKey];\n      // optimisation 1: line below point. no cross\n      if ((iLine.o.y < point.y) && (iLine.d.y < point.y)) {\n        continue;\n      }\n      // optimisation 2: line above point. no cross\n      if ((iLine.o.y >= point.y) && (iLine.d.y >= point.y)) {\n        continue;\n      }\n      // optimisation 3: vertical line case\n      if ((iLine.o.x === iLine.d.x) && (iLine.o.x >= point.x)) {\n        xi = iLine.o.x;\n        // yi = point.y;\n      }\n      // calculate the intersection point\n      else {\n        b1 = 0;\n        b2 = (iLine.d.y - iLine.o.y) / (iLine.d.x - iLine.o.x);\n        a1 = point.y - b1 * point.x;\n        a2 = iLine.o.y - b2 * iLine.o.x;\n\n        xi = -(a1 - a2) / (b1 - b2);\n        // yi = a1 + b1 * xi;\n      }\n      // dont count xi < point.x cases\n      if (xi >= point.x) {\n        xcount += 1;\n      }\n      // optimisation 4: specific for square images\n      if (xcount === 2) {\n        break;\n      }\n    }\n    return xcount;\n  },\n\n  getBoundingRect: function (absolute, calculate) {\n    let coords = this.getCoords(absolute, calculate);\n    return makeBoundingBoxFromPoints(coords);\n  },\n\n  getScaledWidth: function () {\n    return this._getTransformedDimensions().x;\n  },\n\n  getScaledHeight: function () {\n    return this._getTransformedDimensions().y;\n  },\n\n  _constrainScale: function (value) {\n    if (Math.abs(value) < this.minScaleLimit) {\n      if (value < 0) {\n        return -this.minScaleLimit;\n      } else {\n        return this.minScaleLimit;\n      }\n    } else if (value === 0) {\n      return 0.0001;\n    }\n    return value;\n  },\n\n  scale: function (value) {\n    this._set('scaleX', value);\n    this._set('scaleY', value);\n    return this.setCoords();\n  },\n\n  scaleToWidth: function (value, absolute) {\n    // adjust to bounding rect factor so that rotated shapes would fit as well\n    let boundingRectFactor = this.getBoundingRect(absolute).width / this.getScaledWidth();\n    return this.scale(value / this.width / boundingRectFactor);\n  },\n\n  scaleToHeight: function (value, absolute) {\n    // adjust to bounding rect factor so that rotated shapes would fit as well\n    let boundingRectFactor = this.getBoundingRect(absolute).height / this.getScaledHeight();\n    return this.scale(value / this.height / boundingRectFactor);\n  },\n\n  calcCoords: function (absolute) {\n    // this is a compatibility function to avoid removing calcCoords now.\n    if (absolute) {\n      return this.calcACoords();\n    }\n    return this.calcOCoords();\n  },\n\n  calcLineCoords: function () {\n    var vpt = this.getViewportTransform(),\n      padding = this.padding, angle = degreesToRadians(this.angle),\n      c = cos(angle), s = sin(angle),\n      cosP = c * padding, sinP = s * padding, cosPSinP = cosP + sinP,\n      cosPMinusSinP = cosP - sinP, aCoords = this.calcACoords();\n\n    let lineCoords = {\n      tl: transformPoint(aCoords.tl, vpt),\n      tr: transformPoint(aCoords.tr, vpt),\n      bl: transformPoint(aCoords.bl, vpt),\n      br: transformPoint(aCoords.br, vpt),\n    };\n\n    if (padding) {\n      lineCoords.tl.x -= cosPMinusSinP;\n      lineCoords.tl.y -= cosPSinP;\n      lineCoords.tr.x += cosPSinP;\n      lineCoords.tr.y -= cosPMinusSinP;\n      lineCoords.bl.x -= cosPSinP;\n      lineCoords.bl.y += cosPMinusSinP;\n      lineCoords.br.x += cosPMinusSinP;\n      lineCoords.br.y += cosPSinP;\n    }\n\n    return lineCoords;\n  },\n\n  calcOCoords: function () {\n    var rotateMatrix = this._calcRotateMatrix(),\n      translateMatrix = this._calcTranslateMatrix(),\n      vpt = this.getViewportTransform(),\n      startMatrix = multiplyTransformMatrices(vpt, translateMatrix),\n      finalMatrix = multiplyTransformMatrices(startMatrix, rotateMatrix),\n      finalMatrix = multiplyTransformMatrices(finalMatrix, [1 / vpt[0], 0, 0, 1 / vpt[3], 0, 0]),\n      dim = this._calculateCurrentDimensions(),\n      coords = {};\n    this.forEachControl(function (control, key, object) {\n      coords[key] = control.positionHandler(dim, finalMatrix, object);\n    });\n\n    // debug code\n    // let canvas = this.canvas;\n    // setTimeout(function() {\n    //   canvas.contextTop.clearRect(0, 0, 700, 700);\n    //   canvas.contextTop.fillStyle = 'green';\n    //   Object.keys(coords).forEach(function(key) {\n    //     let control = coords[key];\n    //     canvas.contextTop.fillRect(control.x, control.y, 3, 3);\n    //   });\n    // }, 50);\n    return coords;\n  },\n\n  calcACoords: function () {\n    let rotateMatrix = this._calcRotateMatrix(),\n      translateMatrix = this._calcTranslateMatrix(),\n      finalMatrix = multiplyTransformMatrices(translateMatrix, rotateMatrix),\n      dim = this._getTransformedDimensions(),\n      w = dim.x / 2, h = dim.y / 2;\n    return {\n      // corners\n      tl: transformPoint({x: -w, y: -h}, finalMatrix),\n      tr: transformPoint({x: w, y: -h}, finalMatrix),\n      bl: transformPoint({x: -w, y: h}, finalMatrix),\n      br: transformPoint({x: w, y: h}, finalMatrix)\n    };\n  },\n\n  setCoords: function (skipCorners) {\n    this.aCoords = this.calcACoords();\n    this.lineCoords = this.calcLineCoords();\n    if (skipCorners) {\n      return this;\n    }\n    // set coordinates of the draggable boxes in the corners used to scale/rotate the image\n    this.oCoords = this.calcOCoords();\n    this._setCornerCoords && this._setCornerCoords();\n    return this;\n  },\n\n  _calcRotateMatrix: function () {\n    return calcRotateMatrix(this);\n  },\n\n  _calcTranslateMatrix: function () {\n    let center = this.getCenterPoint();\n    return [1, 0, 0, 1, center.x, center.y];\n  },\n\n  transformMatrixKey: function (skipGroup) {\n    let sep = '_', prefix = '';\n    if (!skipGroup && this.group) {\n      prefix = this.group.transformMatrixKey(skipGroup) + sep;\n    }\n    ;\n    return prefix + this.top + sep + this.left + sep + this.scaleX + sep + this.scaleY +\n      sep + this.skewX + sep + this.skewY + sep + this.angle + sep + this.originX + sep + this.originY +\n      sep + this.width + sep + this.height + sep + this.strokeWidth + this.flipX + this.flipY;\n  },\n\n  calcTransformMatrix: function (skipGroup) {\n    let matrix = this.calcOwnMatrix();\n    if (skipGroup || !this.group) {\n      return matrix;\n    }\n    let key = this.transformMatrixKey(skipGroup), cache = this.matrixCache || (this.matrixCache = {});\n    if (cache.key === key) {\n      return cache.value;\n    }\n    if (this.group) {\n      matrix = multiplyTransformMatrices(this.group.calcTransformMatrix(false), matrix);\n    }\n    cache.key = key;\n    cache.value = matrix;\n    return matrix;\n  },\n\n  calcOwnMatrix: function () {\n    let key = this.transformMatrixKey(true), cache = this.ownMatrixCache || (this.ownMatrixCache = {});\n    if (cache.key === key) {\n      return cache.value;\n    }\n    let tMatrix = this._calcTranslateMatrix(),\n      options = {\n        angle: this.angle,\n        translateX: tMatrix[4],\n        translateY: tMatrix[5],\n        scaleX: this.scaleX,\n        scaleY: this.scaleY,\n        skewX: this.skewX,\n        skewY: this.skewY,\n        flipX: this.flipX,\n        flipY: this.flipY,\n      };\n    cache.key = key;\n    cache.value = composeMatrix(options);\n    return cache.value;\n  },\n\n  _calcDimensionsTransformMatrix: function (skewX, skewY, flipping) {\n    return calcDimensionsMatrix({\n      skewX: skewX,\n      skewY: skewY,\n      scaleX: this.scaleX * (flipping && this.flipX ? -1 : 1),\n      scaleY: this.scaleY * (flipping && this.flipY ? -1 : 1)\n    });\n  },\n\n  _getNonTransformedDimensions: function () {\n    let strokeWidth = this.strokeWidth,\n      w = this.width + strokeWidth,\n      h = this.height + strokeWidth;\n    return {x: w, y: h};\n  },\n\n  _getTransformedDimensions: function (skewX, skewY) {\n    if (typeof skewX === 'undefined') {\n      skewX = this.skewX;\n    }\n    if (typeof skewY === 'undefined') {\n      skewY = this.skewY;\n    }\n    let dimensions = this._getNonTransformedDimensions(), dimX, dimY,\n      noSkew = skewX === 0 && skewY === 0;\n\n    if (this.strokeUniform) {\n      dimX = this.width;\n      dimY = this.height;\n    } else {\n      dimX = dimensions.x;\n      dimY = dimensions.y;\n    }\n    if (noSkew) {\n      return this._finalizeDimensions(dimX * this.scaleX, dimY * this.scaleY);\n    }\n    let bbox = sizeAfterTransform(dimX, dimY, {\n      scaleX: this.scaleX,\n      scaleY: this.scaleY,\n      skewX: skewX,\n      skewY: skewY,\n    });\n    return this._finalizeDimensions(bbox.x, bbox.y);\n  },\n\n  _finalizeDimensions: function (width, height) {\n    return this.strokeUniform ?\n      {x: width + this.strokeWidth, y: height + this.strokeWidth}\n      :\n      {x: width, y: height};\n  },\n\n  _calculateCurrentDimensions: function () {\n    let vpt = this.getViewportTransform(),\n      dim = this._getTransformedDimensions(),\n      p = transformPoint(dim, vpt, true);\n    return p.scalarAdd(2 * this.padding);\n  },\n}\n","/**\n * Created by Sugar on 2020/5/30.\n */\nconst PointClass = require('./point.class')\n\nclass IntersectionClass {\n  constructor(status) {\n    this.status = status;\n    this.points = [];\n  }\n\n  appendPoint(point) {\n    this.points.push(point);\n    return this;\n  }\n\n  appendPoints(points) {\n    this.points = this.points.concat(points);\n    return this;\n  }\n}\n\nIntersectionClass.intersectLineLine = function (a1, a2, b1, b2) {\n  let result,\n    uaT = (b2.x - b1.x) * (a1.y - b1.y) - (b2.y - b1.y) * (a1.x - b1.x),\n    ubT = (a2.x - a1.x) * (a1.y - b1.y) - (a2.y - a1.y) * (a1.x - b1.x),\n    uB = (b2.y - b1.y) * (a2.x - a1.x) - (b2.x - b1.x) * (a2.y - a1.y);\n  if (uB !== 0) {\n    let ua = uaT / uB,\n      ub = ubT / uB;\n    if (0 <= ua && ua <= 1 && 0 <= ub && ub <= 1) {\n      result = new IntersectionClass('Intersection');\n      result.appendPoint(new PointClass(a1.x + ua * (a2.x - a1.x), a1.y + ua * (a2.y - a1.y)));\n    } else {\n      result = new Intersection();\n    }\n  } else {\n    if (uaT === 0 || ubT === 0) {\n      result = new IntersectionClass('Coincident');\n    } else {\n      result = new IntersectionClass('Parallel');\n    }\n  }\n  return result;\n}\n\nIntersectionClass.intersectLinePolygon = function (a1, a2, points) {\n  let result = new IntersectionClass(),\n    length = points.length,\n    b1, b2, inter, i;\n\n  for (i = 0; i < length; i++) {\n    b1 = points[i];\n    b2 = points[(i + 1) % length];\n    inter = IntersectionClass.intersectLineLine(a1, a2, b1, b2);\n\n    result.appendPoints(inter.points);\n  }\n  if (result.points.length > 0) {\n    result.status = 'Intersection';\n  }\n  return result;\n}\n\nIntersectionClass.intersectPolygonPolygon = function (points1, points2) {\n  let result = new IntersectionClass(),\n    length = points1.length, i;\n\n  for (i = 0; i < length; i++) {\n    let a1 = points1[i],\n      a2 = points1[(i + 1) % length],\n      inter = IntersectionClass.intersectLinePolygon(a1, a2, points2);\n\n    result.appendPoints(inter.points);\n  }\n  if (result.points.length > 0) {\n    result.status = 'Intersection';\n  }\n  return result;\n};\n\nIntersectionClass.intersectPolygonRectangle = function (points, r1, r2) {\n  let min = r1.min(r2),\n    max = r1.max(r2),\n    topRight = new PointClass(max.x, min.y),\n    bottomLeft = new PointClass(min.x, max.y),\n    inter1 = IntersectionClass.intersectLinePolygon(min, topRight, points),\n    inter2 = IntersectionClass.intersectLinePolygon(topRight, max, points),\n    inter3 = IntersectionClass.intersectLinePolygon(max, bottomLeft, points),\n    inter4 = IntersectionClass.intersectLinePolygon(bottomLeft, min, points),\n    result = new IntersectionClass();\n\n  result.appendPoints(inter1.points);\n  result.appendPoints(inter2.points);\n  result.appendPoints(inter3.points);\n  result.appendPoints(inter4.points);\n\n  if (result.points.length > 0) {\n    result.status = 'Intersection';\n  }\n  return result;\n};\n\nmodule.exports = IntersectionClass\n","/**\n * Created by Sugar on 2020/5/27.\n */\nconst {extend} = require('../utils/object')\n\nmodule.exports = {\n  isEmptyStyles(lineIndex) {\n    if (!this.styles) {\n      return true;\n    }\n    if (typeof lineIndex !== 'undefined' && !this.styles[lineIndex]) {\n      return true;\n    }\n    let obj = typeof lineIndex === 'undefined' ? this.styles : {line: this.styles[lineIndex]};\n    for (let p1 in obj) {\n      for (let p2 in obj[p1]) {\n        for (let p3 in obj[p1][p2]) {\n          return false;\n        }\n      }\n    }\n    return true;\n  },\n\n  styleHas(property, lineIndex) {\n    if (!this.styles || !property || property === '') {\n      return false;\n    }\n    if (typeof lineIndex !== 'undefined' && !this.styles[lineIndex]) {\n      return false;\n    }\n    let obj = typeof lineIndex === 'undefined' ? this.styles : {0: this.styles[lineIndex]};\n    for (let p1 in obj) {\n      for (let p2 in obj[p1]) {\n        if (typeof obj[p1][p2][property] !== 'undefined') {\n          return true;\n        }\n      }\n    }\n    return false;\n  },\n\n  cleanStyle(property) {\n    if (!this.styles || !property || property === '') {\n      return false;\n    }\n    let obj = this.styles, stylesCount = 0, letterCount, stylePropertyValue,\n      allStyleObjectPropertiesMatch = true, graphemeCount = 0, styleObject;\n    // eslint-disable-next-line\n    for (let p1 in obj) {\n      letterCount = 0;\n      // eslint-disable-next-line\n      for (let p2 in obj[p1]) {\n        let styleObject = obj[p1][p2],\n          stylePropertyHasBeenSet = styleObject.hasOwnProperty(property);\n\n        stylesCount++;\n\n        if (stylePropertyHasBeenSet) {\n          if (!stylePropertyValue) {\n            stylePropertyValue = styleObject[property];\n          } else if (styleObject[property] !== stylePropertyValue) {\n            allStyleObjectPropertiesMatch = false;\n          }\n\n          if (styleObject[property] === this[property]) {\n            delete styleObject[property];\n          }\n        } else {\n          allStyleObjectPropertiesMatch = false;\n        }\n\n        if (Object.keys(styleObject).length !== 0) {\n          letterCount++;\n        } else {\n          delete obj[p1][p2];\n        }\n      }\n\n      if (letterCount === 0) {\n        delete obj[p1];\n      }\n    }\n    for (let i = 0; i < this._textLines.length; i++) {\n      graphemeCount += this._textLines[i].length;\n    }\n    if (allStyleObjectPropertiesMatch && stylesCount === graphemeCount) {\n      this[property] = stylePropertyValue;\n      this.removeStyle(property);\n    }\n  },\n\n  removeStyle(property) {\n    if (!this.styles || !property || property === '') {\n      return;\n    }\n    let obj = this.styles, line, lineNum, charNum;\n    for (lineNum in obj) {\n      line = obj[lineNum];\n      for (charNum in line) {\n        delete line[charNum][property];\n        if (Object.keys(line[charNum]).length === 0) {\n          delete line[charNum];\n        }\n      }\n      if (Object.keys(line).length === 0) {\n        delete obj[lineNum];\n      }\n    }\n  },\n\n  _extendStyles(index, styles) {\n    let loc = this.get2DCursorLocation(index);\n\n    if (!this._getLineStyle(loc.lineIndex)) {\n      this._setLineStyle(loc.lineIndex);\n    }\n\n    if (!this._getStyleDeclaration(loc.lineIndex, loc.charIndex)) {\n      this._setStyleDeclaration(loc.lineIndex, loc.charIndex, {});\n    }\n\n    extend(this._getStyleDeclaration(loc.lineIndex, loc.charIndex), styles);\n  },\n\n  get2DCursorLocation(selectionStart, skipWrapping) {\n    if (typeof selectionStart === 'undefined') {\n      selectionStart = this.selectionStart;\n    }\n    let lines = skipWrapping ? this._unwrappedTextLines : this._textLines,\n      len = lines.length;\n    for (let i = 0; i < len; i++) {\n      if (selectionStart <= lines[i].length) {\n        return {\n          lineIndex: i,\n          charIndex: selectionStart\n        };\n      }\n      selectionStart -= lines[i].length + this.missingNewlineOffset(i);\n    }\n    return {\n      lineIndex: i - 1,\n      charIndex: lines[i - 1].length < selectionStart ? lines[i - 1].length : selectionStart\n    };\n  },\n\n  getSelectionStyles(startIndex, endIndex, complete) {\n    if (typeof startIndex === 'undefined') {\n      startIndex = this.selectionStart || 0;\n    }\n    if (typeof endIndex === 'undefined') {\n      endIndex = this.selectionEnd || startIndex;\n    }\n    let styles = [];\n    for (let i = startIndex; i < endIndex; i++) {\n      styles.push(this.getStyleAtPosition(i, complete));\n    }\n    return styles;\n  },\n\n  getStyleAtPosition(position, complete) {\n    let loc = this.get2DCursorLocation(position),\n      style = complete ? this.getCompleteStyleDeclaration(loc.lineIndex, loc.charIndex) :\n        this._getStyleDeclaration(loc.lineIndex, loc.charIndex);\n    return style || {};\n  },\n\n  setSelectionStyles(styles, startIndex, endIndex) {\n    if (typeof startIndex === 'undefined') {\n      startIndex = this.selectionStart || 0;\n    }\n    if (typeof endIndex === 'undefined') {\n      endIndex = this.selectionEnd || startIndex;\n    }\n    for (let i = startIndex; i < endIndex; i++) {\n      this._extendStyles(i, styles);\n    }\n    this._forceClearCache = true;\n    return this;\n  },\n\n  _getStyleDeclaration(lineIndex, charIndex) {\n    let lineStyle = this.styles && this.styles[lineIndex];\n    if (!lineStyle) {\n      return null;\n    }\n    return lineStyle[charIndex];\n  },\n\n  getCompleteStyleDeclaration(lineIndex, charIndex) {\n    let style = this._getStyleDeclaration(lineIndex, charIndex) || {},\n      styleObject = {}, prop;\n    for (let i = 0; i < this._styleProperties.length; i++) {\n      prop = this._styleProperties[i];\n      styleObject[prop] = typeof style[prop] === 'undefined' ? this[prop] : style[prop];\n    }\n    return styleObject;\n  },\n\n  _setStyleDeclaration(lineIndex, charIndex, style) {\n    this.styles[lineIndex][charIndex] = style;\n  },\n\n  _deleteStyleDeclaration(lineIndex, charIndex) {\n    delete this.styles[lineIndex][charIndex];\n  },\n\n  _getLineStyle(lineIndex) {\n    return !!this.styles[lineIndex];\n  },\n\n  _setLineStyle(lineIndex) {\n    this.styles[lineIndex] = {};\n  },\n\n  _deleteLineStyle(lineIndex) {\n    delete this.styles[lineIndex];\n  }\n}\n"],"sourceRoot":""}